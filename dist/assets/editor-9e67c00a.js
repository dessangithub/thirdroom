var Fi=Object.defineProperty;var Gi=(e,t,r)=>t in e?Fi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var K=(e,t,r)=>(Gi(e,typeof t!="symbol"?t+"":t,r),r);import{f as Vi,af as kt,ag as En,r as Vt,d as zi,n as Le}from"./main.cc7980d7.js";import{A as Ue,a as wt,f as Lr,b as Hi,e as Er,h as Xi,n as qi,E as ji,i as Yi,j as Ki,k as Kn,s as $n,o as Jn,c as Rt}from"./Deferred-af9e678f.js";const _e=e=>()=>{for(let t=0;t<e.length;t++){const r=e[t];r()}};function W(e,t){return e.modules.get(t)}var D=(e=>(e.Main="main",e.Game="game",e.Render="render",e.Shared="shared",e))(D||{});function Gc(e){return e}async function $i(e,t,r){const{dispose:n,sendDeferredMessage:a,waitForDeferredMessage:i,handleDeferredMessages:o}=Ji(e,t,"module-loader"),f=g=>({sendMessage:a,waitForMessage:i});async function l(g){const E=g.create(t,f(g.name)),_=E instanceof Promise?await E:E;t.modules.set(g,_)}if(e==="main"){const g=r.map(A=>A.name),[E,_]=await Promise.all([i("render","ModuleList"),i("game","ModuleList")]),O=Array.from(new Set([...g,...E,..._])).sort();for(const A of O){const y=[],P=r.find(M=>M.name===A);P&&y.push(l(P)),E.includes(A)&&(a("render","CreateModule",A),y.push(i("render","ModuleCreated"))),_.includes(A)&&(a("game","CreateModule",A),y.push(i("game","ModuleCreated"))),await Promise.all(y)}a("render","ModuleCreationFinished"),a("game","ModuleCreationFinished")}else{const g=o("main","CreateModule",async E=>{const _=r.find(O=>O.name===E);if(!_)throw new Error(`Module ${E} not found on thread ${e}`);await l(_),a("main","ModuleCreated")});a("main","ModuleList",r.map(E=>E.name)),await i("main","ModuleCreationFinished"),g()}const d=[];for(const g of r){const E=g.init(t);let _;typeof E=="object"?_=await E:_=E,_&&d.push(_)}return e==="main"?(await Promise.all([i("render","ModulesInitialized"),i("game","ModulesInitialized")]),a("render","Complete"),a("game","Complete")):(a("main","ModulesInitialized"),await i("main","Complete")),n(),()=>{for(const g of d)g()}}function ce(e,t,r){let n=e.messageHandlers.get(t);return n||(n=[],e.messageHandlers.set(t,n)),n.push(r),()=>{const a=e.messageHandlers.get(t);if(a){const i=a.indexOf(r);i!==-1&&a.splice(i,1)}}}function Ji(e,t,r){const n=[],a=[],i=[],o=ce(t,r,(g,E)=>{const _=n.findIndex(y=>y.key===E.key&&y.fromThread===E.fromThread),O=n[_];if(O){clearTimeout(O.timeoutId),n.splice(_,1),O.resolve(E.data);return}const A=i.find(y=>y.key===E.key&&y.fromThread===E.fromThread);if(A){A.callback(E.data);return}a.push(E)});function f(g,E,_,O){t.sendMessage(g,{type:r,fromThread:e,key:E,data:_},O)}function l(g,E){const _=a.findIndex(O=>O.key===E&&O.fromThread===g);if(_!==-1){const O=a[_];return a.splice(_,1),Promise.resolve(O.data)}return new Promise((O,A)=>{const y=self.setTimeout(()=>{A(new Error(`timeout reached while waiting on message ${E} from thread ${g} on thread ${e}`))},3e4),P={fromThread:g,key:E,resolve:O,reject:A,timeoutId:y};n.push(P)})}function d(g,E,_){const O=a.filter(y=>y.fromThread===g&&y.key===E);for(const y of O)_(y.data);const A={fromThread:g,key:E,callback:_};return i.push(A),()=>{const y=i.indexOf(A);y!==-1&&i.splice(y,1)}}return{dispose:o,waitForDeferredMessage:l,sendDeferredMessage:f,handleDeferredMessages:d}}function Vc(e){return e}var ae=(e=>(e.EnterWorld="enter-world",e.EnteredWorld="entered-world",e.EnterWorldError="enter-world-error",e.ExitWorld="exit-world",e.ExitedWorld="exited-world",e.LoadWorld="load-world",e.WorldLoaded="world-loaded",e.WorldLoadError="world-load-error",e.PrintThreadState="print-thread-state",e.PrintResources="print-resources",e.ReticleFocus="reticle-focus",e.FindResourceRetainers="find-resource-retainers",e.SetActionBarItems="set-action-bar-items",e.SetObjectCap="set-object-cap",e.ObjectCapReached="object-cap-reached",e.ReloadWorld="reload-world",e.ReloadedWorld="reloaded-world",e.ReloadWorldError="reload-world-error",e))(ae||{});function yr(e,t,r,n){return new(r||(r=Promise))(function(a,i){function o(d){try{l(n.next(d))}catch(g){i(g)}}function f(d){try{l(n.throw(d))}catch(g){i(g)}}function l(d){var g;d.done?a(d.value):(g=d.value,g instanceof r?g:new r(function(E){E(g)})).then(o,f)}l((n=n.apply(e,t||[])).next())})}const Zi=["geforce 320m","geforce 8600","geforce 8600m gt","geforce 8800 gs","geforce 8800 gt","geforce 9400","geforce 9400m g","geforce 9400m","geforce 9600m gt","geforce 9600m","geforce fx go5200","geforce gt 120","geforce gt 130","geforce gt 330m","geforce gtx 285","google swiftshader","intel g41","intel g45","intel gma 4500mhd","intel gma x3100","intel hd 3000","intel q45","legacy","mali-2","mali-3","mali-4","quadro fx 1500","quadro fx 4","quadro fx 5","radeon hd 2400","radeon hd 2600","radeon hd 4670","radeon hd 4850","radeon hd 4870","radeon hd 5670","radeon hd 5750","radeon hd 6290","radeon hd 6300","radeon hd 6310","radeon hd 6320","radeon hd 6490m","radeon hd 6630m","radeon hd 6750m","radeon hd 6770m","radeon hd 6970m","sgx 543","sgx543"];function yn(e){return e=e.toLowerCase().replace(/.*angle ?\((.+)\)(?: on vulkan [0-9.]+)?$/i,"$1").replace(/\s(\d{1,2}gb|direct3d.+$)|\(r\)| \([^)]+\)$/g,"").replace(/(?:vulkan|opengl) \d+\.\d+(?:\.\d+)?(?: \((.*)\))?/,"$1")}const Zn=typeof window>"u",Ce=(()=>{if(Zn)return;const{userAgent:e,platform:t,maxTouchPoints:r}=window.navigator,n=/(iphone|ipod|ipad)/i.test(e),a=t==="iPad"||t==="MacIntel"&&r>0&&!window.MSStream;return{isIpad:a,isMobile:/android/i.test(e)||n||a,isSafari12:/Version\/12.+Safari/.test(e)}})();function Qi(e,t,r){if(!r)return[t];const n=function(d){const g=`
    precision highp float;
    attribute vec3 aPosition;
    varying float vvv;
    void main() {
      vvv = 0.31622776601683794;
      gl_Position = vec4(aPosition, 1.0);
    }
  `,E=`
    precision highp float;
    varying float vvv;
    void main() {
      vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * vvv;
      enc = fract(enc);
      enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);
      gl_FragColor = enc;
    }
  `,_=d.createShader(35633),O=d.createShader(35632),A=d.createProgram();if(!(O&&_&&A))return;d.shaderSource(_,g),d.shaderSource(O,E),d.compileShader(_),d.compileShader(O),d.attachShader(A,_),d.attachShader(A,O),d.linkProgram(A),d.detachShader(A,_),d.detachShader(A,O),d.deleteShader(_),d.deleteShader(O),d.useProgram(A);const y=d.createBuffer();d.bindBuffer(34962,y),d.bufferData(34962,new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),35044);const P=d.getAttribLocation(A,"aPosition");d.vertexAttribPointer(P,3,5126,!1,0,0),d.enableVertexAttribArray(P),d.clearColor(1,1,1,1),d.clear(16384),d.viewport(0,0,1,1),d.drawArrays(4,0,3);const M=new Uint8Array(4);return d.readPixels(0,0,1,1,6408,5121,M),d.deleteProgram(A),d.deleteBuffer(y),M.join("")}(e),a="801621810",i="8016218135",o="80162181161",f=Ce!=null&&Ce.isIpad?[["a7",o,12],["a8",i,15],["a8x",i,15],["a9",i,15],["a9x",i,15],["a10",i,15],["a10x",i,15],["a12",a,15],["a12x",a,15],["a12z",a,15],["a14",a,15],["m1",a,15]]:[["a7",o,12],["a8",i,12],["a9",i,15],["a10",i,15],["a11",a,15],["a12",a,15],["a13",a,15],["a14",a,15]];let l;return n==="80162181255"?l=f.filter(([,,d])=>d>=14):(l=f.filter(([,d])=>d===n),l.length||(l=f)),l.map(([d])=>`apple ${d} gpu`)}class bn extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}const br=[],wn=[];function eo(e,t){if(e===t)return 0;const r=e;e.length>t.length&&(e=t,t=r);let n=e.length,a=t.length;for(;n>0&&e.charCodeAt(~-n)===t.charCodeAt(~-a);)n--,a--;let i,o=0;for(;o<n&&e.charCodeAt(o)===t.charCodeAt(o);)o++;if(n-=o,a-=o,n===0)return a;let f,l,d=0,g=0,E=0;for(;g<n;)wn[g]=e.charCodeAt(o+g),br[g]=++g;for(;E<a;)for(i=t.charCodeAt(o+E),f=E++,d=E,g=0;g<n;g++)l=i===wn[g]?f:f+1,f=br[g],d=br[g]=f>d?l>d?d+1:l:l>f?f+1:l;return d}function to(e){return e!=null}const ro=({mobileTiers:e=[0,15,30,60],desktopTiers:t=[0,15,30,60],override:r={},glContext:n,failIfMajorPerformanceCaveat:a=!1,benchmarksURL:i="https://unpkg.com/detect-gpu@5.0.13/dist/benchmarks"}={})=>yr(void 0,void 0,void 0,function*(){const o={};if(Zn)return{tier:0,type:"SSR"};const{isIpad:f=!!(Ce!=null&&Ce.isIpad),isMobile:l=!!(Ce!=null&&Ce.isMobile),screenSize:d=window.screen,loadBenchmarks:g=C=>yr(void 0,void 0,void 0,function*(){const U=yield fetch(`${i}/${C}`).then(T=>T.json());if(parseInt(U.shift().split(".")[0],10)<4)throw new bn("Detect GPU benchmark data is out of date. Please update to version 4x");return U})}=r;let{renderer:E}=r;const _=(C,U,T,k,j)=>({device:j,fps:k,gpu:T,isMobile:l,tier:C,type:U});let O,A="";if(E)E=yn(E),O=[E];else{const C=n||function(T,k=!1){const j={alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:k,powerPreference:"high-performance",stencil:!1};T&&delete j.powerPreference;const $=window.document.createElement("canvas"),ne=$.getContext("webgl",j)||$.getContext("experimental-webgl",j);return ne??void 0}(Ce==null?void 0:Ce.isSafari12,a);if(!C)return _(0,"WEBGL_UNSUPPORTED");const U=C.getExtension("WEBGL_debug_renderer_info");if(U&&(E=C.getParameter(U.UNMASKED_RENDERER_WEBGL)),!E)return _(1,"FALLBACK");A=E,E=yn(E),O=function(T,k,j){return k==="apple gpu"?Qi(T,k,j):[k]}(C,E,l)}const y=(yield Promise.all(O.map(function(C){var U;return yr(this,void 0,void 0,function*(){const T=(I=>{const Q=l?["adreno","apple","mali-t","mali","nvidia","powervr","samsung"]:["intel","apple","amd","radeon","nvidia","geforce"];for(const se of Q)if(I.includes(se))return se})(C);if(!T)return;const k=`${l?"m":"d"}-${T}${f?"-ipad":""}.json`,j=o[k]=(U=o[k])!==null&&U!==void 0?U:g(k);let $;try{$=yield j}catch(I){if(I instanceof bn)throw I;return}const ne=function(I){var Q;const se=(I=I.replace(/\([^)]+\)/,"")).match(/\d+/)||I.match(/(\W|^)([A-Za-z]{1,3})(\W|$)/g);return(Q=se==null?void 0:se.join("").replace(/\W|amd/g,""))!==null&&Q!==void 0?Q:""}(C);let le=$.filter(([,I])=>I===ne);le.length||(le=$.filter(([I])=>I.includes(C)));const Ne=le.length;if(Ne===0)return;const At=C.split(/[.,()\[\]/\s]/g).sort().filter((I,Q,se)=>Q===0||I!==se[Q-1]).join(" ");let Xe,[ft,,,,Lt]=Ne>1?le.map(I=>[I,eo(At,I[2])]).sort(([,I],[,Q])=>I-Q)[0][0]:le[0],xe=Number.MAX_VALUE;const{devicePixelRatio:oe}=window,dt=d.width*oe*d.height*oe;for(const I of Lt){const[Q,se]=I,_t=Q*se,mt=Math.abs(dt-_t);mt<xe&&(xe=mt,Xe=I)}if(!Xe)return;const[,,qe,Te]=Xe;return[xe,qe,ft,Te]})}))).filter(to).sort(([C=Number.MAX_VALUE,U],[T=Number.MAX_VALUE,k])=>C===T?U-k:C-T);if(!y.length){const C=Zi.find(U=>E.includes(U));return C?_(0,"BLOCKLISTED",C):_(1,"FALLBACK",`${E} (${A})`)}const[,P,M,H]=y[0];if(P===-1)return _(0,"BLOCKLISTED",M,P,H);const B=l?e:t;let x=0;for(let C=0;C<B.length;C++)P>=B[C]&&(x=C);return _(x,"BENCHMARK",M,P,H)});function no(){return new Worker("/assets/GameWorker-32a8287d.js")}var _r=(e=>(e.InitializeGameWorker="initialize-game-worker",e.InitializeRenderWorker="initialize-render-worker",e))(_r||{});function Qn(){var e=new Ue(9);return Ue!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function kr(){var e=new Ue(4);return Ue!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function ao(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=r*r+n*n+a*a+i*i;return o>0&&(o=1/Math.sqrt(o)),e[0]=r*o,e[1]=n*o,e[2]=a*o,e[3]=i*o,e}(function(){var e=kr();return function(t,r,n,a,i,o){var f,l;for(r||(r=4),n||(n=0),a?l=Math.min(a*r+n,t.length):l=t.length,f=n;f<l;f+=r)e[0]=t[f],e[1]=t[f+1],e[2]=t[f+2],e[3]=t[f+3],i(e,e,o),t[f]=e[0],t[f+1]=e[1],t[f+2]=e[2],t[f+3]=e[3];return t}})();function zt(){var e=new Ue(4);return Ue!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function io(e,t,r){r=r*.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function wr(e,t,r,n){var a=t[0],i=t[1],o=t[2],f=t[3],l=r[0],d=r[1],g=r[2],E=r[3],_,O,A,y,P;return O=a*l+i*d+o*g+f*E,O<0&&(O=-O,l=-l,d=-d,g=-g,E=-E),1-O>ji?(_=Math.acos(O),A=Math.sin(_),y=Math.sin((1-n)*_)/A,P=Math.sin(n*_)/A):(y=1-n,P=n),e[0]=y*a+P*l,e[1]=y*i+P*d,e[2]=y*o+P*g,e[3]=y*f+P*E,e}function oo(e,t){var r=t[0]+t[4]+t[8],n;if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var a=0;t[4]>t[0]&&(a=1),t[8]>t[a*3+a]&&(a=2);var i=(a+1)%3,o=(a+2)%3;n=Math.sqrt(t[a*3+a]-t[i*3+i]-t[o*3+o]+1),e[a]=.5*n,n=.5/n,e[3]=(t[i*3+o]-t[o*3+i])*n,e[i]=(t[i*3+a]+t[a*3+i])*n,e[o]=(t[o*3+a]+t[a*3+o])*n}return e}function zc(e,t,r,n){var a=.5*Math.PI/180;t*=a,r*=a,n*=a;var i=Math.sin(t),o=Math.cos(t),f=Math.sin(r),l=Math.cos(r),d=Math.sin(n),g=Math.cos(n);return e[0]=i*l*g-o*f*d,e[1]=o*f*g+i*l*d,e[2]=o*l*d-i*f*g,e[3]=o*l*g+i*f*d,e}var ea=ao;(function(){var e=wt(),t=Lr(1,0,0),r=Lr(0,1,0);return function(n,a,i){var o=Hi(a,i);return o<-.999999?(Er(e,t,a),Xi(e)<1e-6&&Er(e,r,a),qi(e,e),io(n,e,Math.PI),n):o>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(Er(e,a,i),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+o,ea(n,n))}})();(function(){var e=zt(),t=zt();return function(r,n,a,i,o,f){return wr(e,n,o,f),wr(t,a,i,f),wr(r,e,t,2*f*(1-f)),r}})();(function(){var e=Qn();return function(t,r,n,a){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=a[0],e[4]=a[1],e[7]=a[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],ea(t,oo(t,e))}})();function ta(){var e=new Ue(2);return Ue!=Float32Array&&(e[0]=0,e[1]=0),e}(function(){var e=ta();return function(t,r,n,a,i,o){var f,l;for(r||(r=2),n||(n=0),a?l=Math.min(a*r+n,t.length):l=t.length,f=n;f<l;f+=r)e[0]=t[f],e[1]=t[f+1],i(e,e,o),t[f]=e[0],t[f+1]=e[1];return t}})();var Dr={exports:{}},rt=typeof Reflect=="object"?Reflect:null,Rn=rt&&typeof rt.apply=="function"?rt.apply:function(t,r,n){return Function.prototype.apply.call(t,r,n)},Ft;rt&&typeof rt.ownKeys=="function"?Ft=rt.ownKeys:Object.getOwnPropertySymbols?Ft=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Ft=function(t){return Object.getOwnPropertyNames(t)};function so(e){console&&console.warn&&console.warn(e)}var ra=Number.isNaN||function(t){return t!==t};function Y(){Y.init.call(this)}Dr.exports=Y;Dr.exports.once=fo;Y.EventEmitter=Y;Y.prototype._events=void 0;Y.prototype._eventsCount=0;Y.prototype._maxListeners=void 0;var Sn=10;function Qt(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(Y,"defaultMaxListeners",{enumerable:!0,get:function(){return Sn},set:function(e){if(typeof e!="number"||e<0||ra(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Sn=e}});Y.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Y.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||ra(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function na(e){return e._maxListeners===void 0?Y.defaultMaxListeners:e._maxListeners}Y.prototype.getMaxListeners=function(){return na(this)};Y.prototype.emit=function(t){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var a=t==="error",i=this._events;if(i!==void 0)a=a&&i.error===void 0;else if(!a)return!1;if(a){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var f=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw f.context=o,f}var l=i[t];if(l===void 0)return!1;if(typeof l=="function")Rn(l,this,r);else for(var d=l.length,g=ua(l,d),n=0;n<d;++n)Rn(g[n],this,r);return!0};function aa(e,t,r,n){var a,i,o;if(Qt(r),i=e._events,i===void 0?(i=e._events=Object.create(null),e._eventsCount=0):(i.newListener!==void 0&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),o=i[t]),o===void 0)o=i[t]=r,++e._eventsCount;else if(typeof o=="function"?o=i[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),a=na(e),a>0&&o.length>a&&!o.warned){o.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=e,f.type=t,f.count=o.length,so(f)}return e}Y.prototype.addListener=function(t,r){return aa(this,t,r,!1)};Y.prototype.on=Y.prototype.addListener;Y.prototype.prependListener=function(t,r){return aa(this,t,r,!0)};function uo(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function ia(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},a=uo.bind(n);return a.listener=r,n.wrapFn=a,a}Y.prototype.once=function(t,r){return Qt(r),this.on(t,ia(this,t,r)),this};Y.prototype.prependOnceListener=function(t,r){return Qt(r),this.prependListener(t,ia(this,t,r)),this};Y.prototype.removeListener=function(t,r){var n,a,i,o,f;if(Qt(r),a=this._events,a===void 0)return this;if(n=a[t],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete a[t],a.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){f=n[o].listener,i=o;break}if(i<0)return this;i===0?n.shift():co(n,i),n.length===1&&(a[t]=n[0]),a.removeListener!==void 0&&this.emit("removeListener",t,f||r)}return this};Y.prototype.off=Y.prototype.removeListener;Y.prototype.removeAllListeners=function(t){var r,n,a;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var i=Object.keys(n),o;for(a=0;a<i.length;++a)o=i[a],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(a=r.length-1;a>=0;a--)this.removeListener(t,r[a]);return this};function oa(e,t,r){var n=e._events;if(n===void 0)return[];var a=n[t];return a===void 0?[]:typeof a=="function"?r?[a.listener||a]:[a]:r?lo(a):ua(a,a.length)}Y.prototype.listeners=function(t){return oa(this,t,!0)};Y.prototype.rawListeners=function(t){return oa(this,t,!1)};Y.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):sa.call(e,t)};Y.prototype.listenerCount=sa;function sa(e){var t=this._events;if(t!==void 0){var r=t[e];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Y.prototype.eventNames=function(){return this._eventsCount>0?Ft(this._events):[]};function ua(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function co(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function lo(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function fo(e,t){return new Promise(function(r,n){function a(o){e.removeListener(t,i),n(o)}function i(){typeof e.removeListener=="function"&&e.removeListener("error",a),r([].slice.call(arguments))}ca(e,t,i,{once:!0}),t!=="error"&&mo(e,a,{once:!0})})}function mo(e,t,r){typeof e.on=="function"&&ca(e,"error",t,r)}function ca(e,t,r,n){if(typeof e.on=="function")n.once?e.once(t,r):e.on(t,r);else if(typeof e.addEventListener=="function")e.addEventListener(t,function a(i){n.once&&e.removeEventListener(t,a),r(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var po=Dr.exports;const la=Vi(po);function xr(e,t,r){return(r+ze(e)-t)%ze(e)}function fa(e,t,r){return ho(e)-xr(e,t,r)}function ze(e){return e._capacity}function Ht(e,t,r,n,a){r.set(e.subarray(t,t+a),n)}function Wr(e,t=1e3){const r=8+(t+1)*e.BYTES_PER_ELEMENT,n=new SharedArrayBuffer(r),a=(n.byteLength-8)/e.BYTES_PER_ELEMENT;return{_buffer:n,_capacity:a,_writePtr:new Uint32Array(n,0,1),_readPtr:new Uint32Array(n,4,1),_storage:new e(n,8,a)}}function da(e){const t=Atomics.load(e._readPtr,0);return Atomics.load(e._writePtr,0)===t}function ho(e){return e._capacity-1}function Xt(e){const t=Atomics.load(e._readPtr,0),r=Atomics.load(e._writePtr,0);return xr(e,t,r)}function Fr(e){const t=Atomics.load(e._readPtr,0),r=Atomics.load(e._writePtr,0);return fa(e,t,r)}function Gr(e,t,r=t.length,n=0){const a=Atomics.load(e._readPtr,0),i=Atomics.load(e._writePtr,0);if((i+1)%ze(e)===a)return 0;const o=Math.min(fa(e,a,i),r),f=Math.min(ze(e)-i,o),l=o-f;return Ht(t,n,e._storage,i,f),Ht(t,n+f,e._storage,0,l),Atomics.store(e._writePtr,0,(i+o)%ze(e)),o}function Vr(e,t,r=t.length,n=0){const a=Atomics.load(e._readPtr,0),i=Atomics.load(e._writePtr,0);if(i===a)return 0;const o=Math.min(xr(e,a,i),r),f=Math.min(ze(e)-a,o),l=o-f;return Ht(e._storage,a,t,n,f),Ht(e._storage,0,t,n+f,l),Atomics.store(e._readPtr,0,(a+o)%ze(e)),o}function ma(e){return e.split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function An(e,t,r,n){const a=t.byteOffset/4,i=t.size;t.type==="string"?Object.defineProperty(e.prototype,r,{get(){const o=this.manager.readBufferIndex,f=this.u32Views[o][a];return this.manager.resources.get(f)}}):t.type==="arrayBuffer"?Object.defineProperty(e.prototype,r,{get(){const o=this.manager.readBufferIndex,f=this.u32Views[o][a+2];return this.manager.resources.get(f)}}):t.type==="ref"?Object.defineProperty(e.prototype,r,{get(){const o=this.manager.readBufferIndex,f=this.u32Views[o][a];return this.manager.resources.get(f)}}):t.type==="refArray"?Object.defineProperty(e.prototype,r,{get(){const o=this.manager.readBufferIndex,f=this.u32Views[o],l=this.refArrays[r];l.length=0;for(let d=a;d<a+i&&f[d]!==0;d++){const g=this.manager.resources.get(f[d]);g&&l.push(g)}return l}}):t.type==="refMap"?Object.defineProperty(e.prototype,r,{get(){const o=this.manager.readBufferIndex,f=this.u32Views[o],l=this.refArrays[r];l.length=0;for(let d=a;d<a+i;d++)f[d]?l.push(this.manager.resources.get(f[d])):l.push(void 0);return l}}):t.type==="bool"?Object.defineProperty(e.prototype,r,{get(){const o=this.manager.readBufferIndex;return!!this.u32Views[o][a]}}):t.size===1?t.type==="f32"?Object.defineProperty(e.prototype,r,{get(){const o=this.manager.readBufferIndex;return this.f32Views[o][a]}}):t.type==="i32"?Object.defineProperty(e.prototype,r,{get(){const o=this.manager.readBufferIndex;return this.u32Views[o][a]|0}}):Object.defineProperty(e.prototype,r,{get(){const o=this.manager.readBufferIndex;return this.u32Views[o][a]}}):Object.defineProperty(e.prototype,r,{get(){const o=this.manager.readBufferIndex;return this.vecViews[n][o]}})}function F(e){const{name:t,schema:r,resourceType:n}=e;function a(o,f,l){this.eid=f,this.resourceType=n,this.tripleBuffer=l,this.manager=o;const d=this.tripleBuffer.buffers,g=a.resourceDef.schema;this.u32Views=[new Uint32Array(d[0]),new Uint32Array(d[1]),new Uint32Array(d[2])],this.f32Views=[new Float32Array(d[0]),new Float32Array(d[1]),new Float32Array(d[2])],this.vecViews=[],this.refArrays={};for(const E in g){const _=g[E];_.size>1&&_.arrayType===Float32Array?this.vecViews.push([new _.arrayType(d[0],_.byteOffset,_.size),new _.arrayType(d[1],_.byteOffset,_.size),new _.arrayType(d[2],_.byteOffset,_.size)]):(_.type==="refArray"||_.type==="refMap")&&(this.refArrays[E]=[])}}Object.defineProperties(a,{name:{value:ma(t)},resourceDef:{value:e}}),Object.defineProperties(a.prototype,{resourceDef:{value:e},load:{value(){return Promise.resolve()}},dispose:{value(){}}});let i=0;for(const o in r){const f=r[o];f.size>1&&f.arrayType===Float32Array?An(a,f,o,i++):An(a,f,o,-1)}return a}const go=(e=new Uint8Array(new SharedArrayBuffer(Uint8Array.BYTES_PER_ELEMENT)).fill(6),t=1e7,r=[new SharedArrayBuffer(t),new SharedArrayBuffer(t),new SharedArrayBuffer(t)],n=[new Uint8Array(r[0]),new Uint8Array(r[1]),new Uint8Array(r[2])])=>({byteLength:t,buffers:r,byteViews:n,flags:e}),vo=e=>(e&64)!==0,Eo=e=>e&48|(e&3)<<2|(e&12)>>2,yo=e=>64|(e&12)<<2|(e&48)>>2|e&3,Ln=e=>Atomics.load(e,0)&3,bo=e=>Atomics.load(e.flags,0)&3,wo=e=>(Atomics.load(e.flags,0)&48)>>4,Ro=e=>{const t=Atomics.load(e,0);do if(!vo(t))return!1;while(Atomics.compareExchange(e,0,t,Eo(t))===t);return!0},So=e=>{const t=Atomics.load(e,0);for(;Atomics.compareExchange(e,0,t,yo(t))===t;);};function Ao(e){let t=0;const r=[[],[]],n=()=>{const o=r[t];return t=t?0:1,r[t].length=0,o},a=(o,f)=>{const l=f.messages;for(let d=0;d<l.length;d++)r[t].push(l[d])};return[n,o=>ce(o,e,a)]}const er=(e=new ArrayBuffer(1e5),t=!1)=>{const r=new DataView(e);return r.cursor=0,r.shadowMap=new Map,r.littleEndian=t,r},Lo=e=>{const t=e.buffer.slice(0,e.cursor);return e.cursor=0,t},ct=(e,t)=>(e.cursor=t,e),zr=(e,t)=>(new Uint8Array(e.buffer).set(new Uint8Array(t),e.cursor),e.cursor+=t.byteLength,e),Et=(e,t)=>(e.setFloat32(e.cursor,t,e.littleEndian),e.cursor+=Float32Array.BYTES_PER_ELEMENT,e),nt=(e,t)=>(e.setUint32(e.cursor,t,e.littleEndian),e.cursor+=Uint32Array.BYTES_PER_ELEMENT,e),Hr=(e,t)=>(e.setUint8(e.cursor,t),e.cursor+=Uint8Array.BYTES_PER_ELEMENT,e),_o=new TextEncoder;function No(e,t){const r=_o.encode(t);return Hr(e,r.byteLength),zr(e,r),e}const To=(e,t)=>{const r=e.buffer.slice(e.cursor,e.cursor+t);return e.cursor+=t,r},Rr=e=>{const t=e.getFloat32(e.cursor,e.littleEndian);return e.cursor+=Float32Array.BYTES_PER_ELEMENT,t},at=e=>{const t=e.getUint32(e.cursor,e.littleEndian);return e.cursor+=Uint32Array.BYTES_PER_ELEMENT,t},Xr=e=>{const t=e.getUint8(e.cursor);return e.cursor+=Uint8Array.BYTES_PER_ELEMENT,t},Po=new TextDecoder;function Mo(e,t){t=t||Xr(e);const r=new Uint8Array(e.buffer,e.cursor,t);return e.cursor+=t,Po.decode(r)}const Hc=60,Xc=100,pa=0,_n=2*Uint32Array.BYTES_PER_ELEMENT;function Oo(e,t,r){const{view:n}=e;if(ct(n,0),nt(n,t),nt(n,r),Fr(e)<_n)throw new Error("Resource ring buffer full.");return Gr(e,e.array)===_n}function Co(e,t){return Vr(e,e.array),ct(e.view,0),t.eid=at(e.view),t.tick=at(e.view),t}const ha=e=>t=>Math.ceil(t/e)*e,Nn=ha(4),Tn=ha(8);function Io(e,t){let r=0;for(const f in e){if(f==="buffer")throw new Error('"buffer" is a reserved ObjectBufferView property name.');const[l,d,g]=e[f];r+=l.BYTES_PER_ELEMENT*d*(g||1),r=l.name.includes("32")?Nn(r):l.name.includes("64")?Tn(r):r}const n=new t(r),a=new Uint8Array(n),i={buffer:n,byteView:a};let o=0;for(const f in e){const[l,d,g]=e[f];if(o=l.name.includes("32")?Nn(o):l.name.includes("64")?Tn(o):o,g===void 0){const E=new l(n,o,d);o+=E.byteLength,i[f]=E}else i[f]=Array.from({length:d},()=>{const E=new l(n,o,g);return o+=E.byteLength,E})}return i}function ga(e,t){const r=Array.from({length:3},()=>Io(e,SharedArrayBuffer)),n=r.map(o=>o.buffer),a=r.map(o=>o.byteView),i=go(t,n[0].byteLength,n,a);return{views:r,tripleBuffer:i,initialized:!1}}function va(e){const t=wo(e.tripleBuffer);return e.views[t]}function Bo(e){const t=bo(e.tripleBuffer);return e.views[t]}var Ae=(e=>(e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.Error=3]="Error",e[e.Disposed=4]="Disposed",e))(Ae||{});const Uo="string",ko="arrayBuffer",Do={lastProcessedTick:[Uint32Array,1]},xo=e=>{const[t,r]=Ao("load-resources"),n={name:"resource",async create(A,{waitForMessage:y,sendMessage:P}){const{fromGameStateTripleBufferFlags:M,fromGameState:H,toGameStateTripleBufferFlags:B,disposedResources:x,recycleResources:C}=await y(D.Game,"init-game-resource-module"),U=ga(Do,B);P(D.Game,"init-remote-resource-module",{toGameState:U});const T=new Map,k={resources:T,readBufferIndex:Ln(M)};return{resources:T,resourceInfos:new Map,resourcesByType:new Map,resourceLoaders:new Map,resourceConstructors:[],fromGameState:H,toGameState:U,disposedResources:x,recycleResources:C,recycleResourcesQueue:[],pendingResourceDisposalsQueue:[],lastProcessedTick:0,fromGameStateTripleBufferFlags:M,resourceManager:k,createResourceMessages:[]}},init(A){return _e([...e.map(y=>a(A,y)),i(A,Uo,o),i(A,ko,f),r(A)])}};function a(A,y){const P=W(A,n),M=[],H="resourceDef"in y?y:F(y);P.resourceConstructors.push(H);const B=H.resourceDef;for(const C in B.schema){const U=B.schema[C];if(!U.backRef)if(U.type==="string"||U.type==="ref"||U.type==="refArray"||U.type==="refMap")for(let T=0;T<U.size;T++)M.push(U.byteOffset+T*U.arrayType.BYTES_PER_ELEMENT);else U.type==="arrayBuffer"&&M.push(U.byteOffset+Uint32Array.BYTES_PER_ELEMENT*2)}function x(C,U,T){const k=W(C,n),j=new H(k.resourceManager,U,T);return j.load(C),j}return P.resourceLoaders.set(B.name,x),P.resourcesByType.set(B.name,[]),()=>{P.resourceLoaders.delete(B.name)}}function i(A,y,P){const M=W(A,n);return M.resourceLoaders.set(y,P),()=>{M.resourceLoaders.delete(y)}}function o(A,y,P){return P}function f(A,y,P){return P}function l(A){const y=W(A,n);y.resourceManager.readBufferIndex=Ln(y.fromGameStateTripleBufferFlags);const{disposedResources:P,recycleResources:M,recycleResourcesQueue:H,pendingResourceDisposalsQueue:B,fromGameState:x,createResourceMessages:C}=y;for(A.tick=Bo(x).tick[0];Xt(P);){const T=Co(P,{eid:0,tick:0});B.push(T)}const U=t();for(let T=0;T<U.length;T++){const k=U[T];C.push(k)}for(let T=0;T<B.length;T++){const k=B[T];if(k.tick<=A.tick&&E(A,y,k.eid))k.tick=A.tick,H.push(k),B.splice(T,1),T--;else{const j=C.findIndex($=>$.id===k.eid);j!==-1&&(C.splice(j,1),k.tick=A.tick,H.push(k),B.splice(T,1),T--)}}for(let T=0;T<C.length;T++){const k=C[T];k.tick<=A.tick&&(g(A,y,k),C.splice(T,1),T--)}for(;H.length;){const T=H.shift();Oo(M,T.eid,T.tick)}y.lastProcessedTick=A.tick}function d(A){const{toGameState:y,lastProcessedTick:P}=W(A,n);if(!A.isStaleFrame){const M=va(y);M.lastProcessedTick[0]=P}}function g(A,y,P){const{id:M,resourceType:H,props:B}=P;if(y.resourceInfos.has(M))throw new Error(`Resource ${M} already exists`);const x={id:M,resourceType:H,disposed:!1};y.resourceInfos.set(M,x);const C=y.resourceLoaders.get(H);if(!C)throw new Error(`No registered resource loader for ${H}`);const U=C(A,M,B);y.resources.set(M,U);let T=y.resourcesByType.get(H);return T||(T=[],y.resourcesByType.set(H,T)),T.push(U),x}function E(A,y,P){const{resourceInfos:M,resources:H,resourcesByType:B}=y,x=M.get(P);if(x){const C=H.get(P);if(C){const U=B.get(x.resourceType);if(U){const T=U.indexOf(C);T!==-1&&U.splice(T,1)}typeof C!="string"&&"dispose"in C&&C.dispose(A)}return H.delete(P),x.disposed=!0,M.delete(P),!0}else return!1}function _(A,y){return W(A,n).resources.get(y)}function O(A,y){const P=W(A,n),M="resourceDef"in y?y.resourceDef:y;return P.resourcesByType.get(M.name)||[]}return{ResourceModule:n,registerResource:a,registerResourceLoader:i,getLocalResource:_,getLocalResources:O,ResourceLoaderSystem:l,ReturnRecycledResourcesSystem:d}};var N={},Wo=N.ALIGN_AUTO=0,Fo=N.ALIGN_FLEX_START=1,Go=N.ALIGN_CENTER=2,Vo=N.ALIGN_FLEX_END=3,zo=N.ALIGN_STRETCH=4,Ho=N.ALIGN_BASELINE=5,Xo=N.ALIGN_SPACE_BETWEEN=6,qo=N.ALIGN_SPACE_AROUND=7;N.DIMENSION_WIDTH=0;N.DIMENSION_HEIGHT=1;N.DIRECTION_INHERIT=0;var qc=N.DIRECTION_LTR=1;N.DIRECTION_RTL=2;N.DISPLAY_FLEX=0;N.DISPLAY_NONE=1;var jo=N.EDGE_LEFT=0,Yo=N.EDGE_TOP=1,Ko=N.EDGE_RIGHT=2,$o=N.EDGE_BOTTOM=3;N.EDGE_START=4;N.EDGE_END=5;N.EDGE_HORIZONTAL=6;N.EDGE_VERTICAL=7;N.EDGE_ALL=8;N.EXPERIMENTAL_FEATURE_WEB_FLEX_BASIS=0;N.EXPERIMENTAL_FEATURE_ABSOLUTE_PERCENTAGE_AGAINST_PADDING_EDGE=1;N.EXPERIMENTAL_FEATURE_FIX_ABSOLUTE_TRAILING_COLUMN_MARGIN=2;var Jo=N.FLEX_DIRECTION_COLUMN=0,Zo=N.FLEX_DIRECTION_COLUMN_REVERSE=1,Qo=N.FLEX_DIRECTION_ROW=2,es=N.FLEX_DIRECTION_ROW_REVERSE=3;N.GUTTER_COLUMN=0;N.GUTTER_ROW=1;N.GUTTER_ALL=2;var ts=N.JUSTIFY_FLEX_START=0,rs=N.JUSTIFY_CENTER=1,ns=N.JUSTIFY_FLEX_END=2,as=N.JUSTIFY_SPACE_BETWEEN=3,is=N.JUSTIFY_SPACE_AROUND=4,os=N.JUSTIFY_SPACE_EVENLY=5;N.LOG_LEVEL_ERROR=0;N.LOG_LEVEL_WARN=1;N.LOG_LEVEL_INFO=2;N.LOG_LEVEL_DEBUG=3;N.LOG_LEVEL_VERBOSE=4;N.LOG_LEVEL_FATAL=5;N.MEASURE_MODE_UNDEFINED=0;N.MEASURE_MODE_EXACTLY=1;N.MEASURE_MODE_AT_MOST=2;N.NODE_TYPE_DEFAULT=0;N.NODE_TYPE_TEXT=1;N.OVERFLOW_VISIBLE=0;N.OVERFLOW_HIDDEN=1;N.OVERFLOW_SCROLL=2;N.POSITION_TYPE_STATIC=0;var ss=N.POSITION_TYPE_RELATIVE=1,us=N.POSITION_TYPE_ABSOLUTE=2;N.PRINT_OPTIONS_LAYOUT=1;N.PRINT_OPTIONS_STYLE=2;N.PRINT_OPTIONS_CHILDREN=4;N.UNIT_UNDEFINED=0;N.UNIT_POINT=1;N.UNIT_PERCENT=2;N.UNIT_AUTO=3;var cs=N.WRAP_NO_WRAP=0,ls=N.WRAP_WRAP=1,fs=N.WRAP_WRAP_REVERSE=2,ds=e=>{function t(a,i,o){let f=a[i];a[i]=function(...l){return o.call(this,f,...l)}}for(let a of["setPosition","setMargin","setFlexBasis","setWidth","setHeight","setMinWidth","setMinHeight","setMaxWidth","setMaxHeight","setPadding"]){let i={[N.UNIT_POINT]:e.Node.prototype[a],[N.UNIT_PERCENT]:e.Node.prototype[`${a}Percent`],[N.UNIT_AUTO]:e.Node.prototype[`${a}Auto`]};t(e.Node.prototype,a,function(o,...f){let l,d,g=f.pop();if(g==="auto")l=N.UNIT_AUTO,d=void 0;else if(typeof g=="object")l=g.unit,d=g.valueOf();else if(l=typeof g=="string"&&g.endsWith("%")?N.UNIT_PERCENT:N.UNIT_POINT,d=parseFloat(g),!Number.isNaN(g)&&Number.isNaN(d))throw Error(`Invalid value ${g} for ${a}`);if(!i[l])throw Error(`Failed to execute "${a}": Unsupported unit '${g}'`);return d!==void 0?i[l].call(this,...f,d):i[l].call(this,...f)})}function r(a){return e.MeasureCallback.implement({measure:(...i)=>{let{width:o,height:f}=a(...i);return{width:o??NaN,height:f??NaN}}})}function n(a){return e.DirtiedCallback.implement({dirtied:a})}return t(e.Node.prototype,"setMeasureFunc",function(a,i){return i?a.call(this,r(i)):this.unsetMeasureFunc()}),t(e.Node.prototype,"setDirtiedFunc",function(a,i){a.call(this,n(i))}),t(e.Config.prototype,"free",function(){e.Config.destroy(this)}),t(e.Node,"create",(a,i)=>i?e.Node.createWithConfig(i):e.Node.createDefault()),t(e.Node.prototype,"free",function(){e.Node.destroy(this)}),t(e.Node.prototype,"freeRecursive",function(){for(let a=0,i=this.getChildCount();a<i;++a)this.getChild(0).freeRecursive();this.free()}),t(e.Node.prototype,"calculateLayout",function(a,i=NaN,o=NaN,f=N.DIRECTION_LTR){return a.call(this,i,o,f)}),{Config:e.Config,Node:e.Node,...N}},ms=(()=>{var e=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(t={}){l||(l=t!==void 0?t:{}),l.ready=new Promise(function(u,s){d=u,g=s});var r,n,a=Object.assign({},l),i="";typeof document<"u"&&document.currentScript&&(i=document.currentScript.src),e&&(i=e),i=i.indexOf("blob:")!==0?i.substr(0,i.replace(/[?#].*/,"").lastIndexOf("/")+1):"";var o=console.log.bind(console),f=console.warn.bind(console);Object.assign(l,a),a=null,typeof WebAssembly!="object"&&Ne("no native wasm support detected");var l,d,g,E,_=!1;function O(u,s,m){m=s+m;for(var p="";!(s>=m);){var h=u[s++];if(!h)break;if(128&h){var v=63&u[s++];if((224&h)==192)p+=String.fromCharCode((31&h)<<6|v);else{var w=63&u[s++];65536>(h=(240&h)==224?(15&h)<<12|v<<6|w:(7&h)<<18|v<<12|w<<6|63&u[s++])?p+=String.fromCharCode(h):(h-=65536,p+=String.fromCharCode(55296|h>>10,56320|1023&h))}}else p+=String.fromCharCode(h)}return p}function A(){var u=E.buffer;l.HEAP8=y=new Int8Array(u),l.HEAP16=M=new Int16Array(u),l.HEAP32=B=new Int32Array(u),l.HEAPU8=P=new Uint8Array(u),l.HEAPU16=H=new Uint16Array(u),l.HEAPU32=x=new Uint32Array(u),l.HEAPF32=C=new Float32Array(u),l.HEAPF64=U=new Float64Array(u)}var y,P,M,H,B,x,C,U,T,k=[],j=[],$=[],ne=0,le=null;function Ne(u){throw f(u="Aborted("+u+")"),_=!0,g(u=new WebAssembly.RuntimeError(u+". Build with -sASSERTIONS for more info.")),u}function At(){return r.startsWith("data:application/octet-stream;base64,")}function Xe(){try{throw"both async and sync fetching of the wasm failed"}catch(u){Ne(u)}}function ft(u){for(;0<u.length;)u.shift()(l)}function Lt(u){if(u===void 0)return"_unknown";var s=(u=u.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return 48<=s&&57>=s?"_"+u:u}function xe(u,s){return u=Lt(u),function(){return s.apply(this,arguments)}}r="yoga.wasm",At()||(r=i+r);var oe=[{},{value:void 0},{value:null},{value:!0},{value:!1}],dt=[];function qe(u){var s=Error,m=xe(u,function(p){this.name=u,this.message=p,(p=Error(p).stack)!==void 0&&(this.stack=this.toString()+`
`+p.replace(/^Error(:[^\n]*)?\n/,""))});return m.prototype=Object.create(s.prototype),m.prototype.constructor=m,m.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},m}var Te=void 0;function I(u){throw new Te(u)}var Q=u=>(u||I("Cannot use deleted val. handle = "+u),oe[u].value),se=u=>{switch(u){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var s=dt.length?dt.pop():oe.length;return oe[s]={fa:1,value:u},s}},_t=void 0,mt=void 0;function te(u){for(var s="";P[u];)s+=mt[P[u++]];return s}var pt=[];function ar(){for(;pt.length;){var u=pt.pop();u.L.Z=!1,u.delete()}}var ht=void 0,be={};function ir(u,s){for(s===void 0&&I("ptr should not be undefined");u.P;)s=u.aa(s),u=u.P;return s}var We={};function nn(u){var s=te(u=pn(u));return Se(u),s}function an(u,s){var m=We[u];return m===void 0&&I(s+" has unknown type "+nn(u)),m}function Nt(){}var or=!1;function on(u){--u.count.value,u.count.value===0&&(u.S?u.T.V(u.S):u.O.M.V(u.N))}var sn={},un=void 0;function Tt(u){throw new un(u)}function Pt(u,s){return s.O&&s.N||Tt("makeClassHandle requires ptr and ptrType"),!!s.T!=!!s.S&&Tt("Both smartPtrType and smartPtr must be specified"),s.count={value:1},je(Object.create(u,{L:{value:s}}))}function je(u){return typeof FinalizationRegistry>"u"?(je=s=>s,u):(or=new FinalizationRegistry(s=>{on(s.L)}),je=s=>{var m=s.L;return m.S&&or.register(s,{L:m},s),s},Nt=s=>{or.unregister(s)},je(u))}var Mt={};function sr(u){for(;u.length;){var s=u.pop();u.pop()(s)}}function gt(u){return this.fromWireType(B[u>>2])}var Ye={},Ot={};function Pe(u,s,m){function p(b){(b=m(b)).length!==u.length&&Tt("Mismatched type converter count");for(var R=0;R<u.length;++R)we(u[R],b[R])}u.forEach(function(b){Ot[b]=s});var h=Array(s.length),v=[],w=0;s.forEach((b,R)=>{We.hasOwnProperty(b)?h[R]=We[b]:(v.push(b),Ye.hasOwnProperty(b)||(Ye[b]=[]),Ye[b].push(()=>{h[R]=We[b],++w===v.length&&p(h)}))}),v.length===0&&p(h)}function ur(u){switch(u){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw TypeError("Unknown type size: "+u)}}function we(u,s,m={}){if(!("argPackAdvance"in s))throw TypeError("registerType registeredInstance requires argPackAdvance");var p=s.name;if(u||I('type "'+p+'" must have a positive integer typeid pointer'),We.hasOwnProperty(u)){if(m.ta)return;I("Cannot register type '"+p+"' twice")}We[u]=s,delete Ot[u],Ye.hasOwnProperty(u)&&(s=Ye[u],delete Ye[u],s.forEach(h=>h()))}function cr(u){I(u.L.O.M.name+" instance already deleted")}function Me(){}function lr(u,s,m){if(u[s].R===void 0){var p=u[s];u[s]=function(){return u[s].R.hasOwnProperty(arguments.length)||I("Function '"+m+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+u[s].R+")!"),u[s].R[arguments.length].apply(this,arguments)},u[s].R=[],u[s].R[p.Y]=p}}function Ni(u,s,m,p,h,v,w,b){this.name=u,this.constructor=s,this.W=m,this.V=p,this.P=h,this.oa=v,this.aa=w,this.ma=b,this.ia=[]}function fr(u,s,m){for(;s!==m;)s.aa||I("Expected null or instance of "+m.name+", got an instance of "+s.name),u=s.aa(u),s=s.P;return u}function Ti(u,s){return s===null?(this.da&&I("null is not a valid "+this.name),0):(s.L||I('Cannot pass "'+hr(s)+'" as a '+this.name),s.L.N||I("Cannot pass deleted object as a pointer of type "+this.name),fr(s.L.N,s.L.O.M,this.M))}function Pi(u,s){if(s===null){if(this.da&&I("null is not a valid "+this.name),this.ca){var m=this.ea();return u!==null&&u.push(this.V,m),m}return 0}if(s.L||I('Cannot pass "'+hr(s)+'" as a '+this.name),s.L.N||I("Cannot pass deleted object as a pointer of type "+this.name),!this.ba&&s.L.O.ba&&I("Cannot convert argument of type "+(s.L.T?s.L.T.name:s.L.O.name)+" to parameter type "+this.name),m=fr(s.L.N,s.L.O.M,this.M),this.ca)switch(s.L.S===void 0&&I("Passing raw pointer to smart pointer is illegal"),this.Aa){case 0:s.L.T===this?m=s.L.S:I("Cannot convert argument of type "+(s.L.T?s.L.T.name:s.L.O.name)+" to parameter type "+this.name);break;case 1:m=s.L.S;break;case 2:if(s.L.T===this)m=s.L.S;else{var p=s.clone();m=this.wa(m,se(function(){p.delete()})),u!==null&&u.push(this.V,m)}break;default:I("Unsupporting sharing policy")}return m}function Mi(u,s){return s===null?(this.da&&I("null is not a valid "+this.name),0):(s.L||I('Cannot pass "'+hr(s)+'" as a '+this.name),s.L.N||I("Cannot pass deleted object as a pointer of type "+this.name),s.L.O.ba&&I("Cannot convert argument of type "+s.L.O.name+" to parameter type "+this.name),fr(s.L.N,s.L.O.M,this.M))}function Re(u,s,m,p){this.name=u,this.M=s,this.da=m,this.ba=p,this.ca=!1,this.V=this.wa=this.ea=this.ja=this.Aa=this.va=void 0,s.P!==void 0?this.toWireType=Pi:(this.toWireType=p?Ti:Mi,this.U=null)}var Ct=[];function cn(u){var s=Ct[u];return s||(u>=Ct.length&&(Ct.length=u+1),Ct[u]=s=T.get(u)),s}function pe(u,s){var m,p,h=(u=te(u)).includes("j")?(m=u,p=[],function(){if(p.length=0,Object.assign(p,arguments),m.includes("j")){var v=l["dynCall_"+m];v=p&&p.length?v.apply(null,[s].concat(p)):v.call(null,s)}else v=cn(s).apply(null,p);return v}):cn(s);return typeof h!="function"&&I("unknown function pointer with signature "+u+": "+s),h}var ln=void 0;function It(u,s){var m=[],p={};throw s.forEach(function h(v){p[v]||We[v]||(Ot[v]?Ot[v].forEach(h):(m.push(v),p[v]=!0))}),new ln(u+": "+m.map(nn).join([", "]))}function dr(u,s,m,p,h){var v=s.length;2>v&&I("argTypes array size mismatch! Must at least get return value and 'this' types!");var w=s[1]!==null&&m!==null,b=!1;for(m=1;m<s.length;++m)if(s[m]!==null&&s[m].U===void 0){b=!0;break}var R=s[0].name!=="void",S=v-2,L=Array(S),G=[],z=[];return function(){if(arguments.length!==S&&I("function "+u+" called with "+arguments.length+" arguments, expected "+S+" args!"),z.length=0,G.length=w?2:1,G[0]=h,w){var q=s[1].toWireType(z,this);G[1]=q}for(var X=0;X<S;++X)L[X]=s[X+2].toWireType(z,arguments[X]),G.push(L[X]);if(X=p.apply(null,G),b)sr(z);else for(var Z=w?1:2;Z<s.length;Z++){var Ke=Z===1?q:L[Z-2];s[Z].U!==null&&s[Z].U(Ke)}return R?s[0].fromWireType(X):void 0}}function mr(u,s){for(var m=[],p=0;p<u;p++)m.push(x[s+4*p>>2]);return m}function pr(u){4<u&&--oe[u].fa==0&&(oe[u]=void 0,dt.push(u))}function hr(u){if(u===null)return"null";var s=typeof u;return s==="object"||s==="array"||s==="function"?u.toString():""+u}function Oi(u,s){for(var m="",p=0;!(p>=s/2);++p){var h=M[u+2*p>>1];if(h==0)break;m+=String.fromCharCode(h)}return m}function Ci(u,s,m){if(m===void 0&&(m=2147483647),2>m)return 0;m-=2;var p=s;m=m<2*u.length?m/2:u.length;for(var h=0;h<m;++h)M[s>>1]=u.charCodeAt(h),s+=2;return M[s>>1]=0,s-p}function Ii(u){return 2*u.length}function Bi(u,s){for(var m=0,p="";!(m>=s/4);){var h=B[u+4*m>>2];if(h==0)break;++m,65536<=h?(h-=65536,p+=String.fromCharCode(55296|h>>10,56320|1023&h)):p+=String.fromCharCode(h)}return p}function Ui(u,s,m){if(m===void 0&&(m=2147483647),4>m)return 0;var p=s;m=p+m-4;for(var h=0;h<u.length;++h){var v=u.charCodeAt(h);if(55296<=v&&57343>=v&&(v=65536+((1023&v)<<10)|1023&u.charCodeAt(++h)),B[s>>2]=v,(s+=4)+4>m)break}return B[s>>2]=0,s-p}function ki(u){for(var s=0,m=0;m<u.length;++m){var p=u.charCodeAt(m);55296<=p&&57343>=p&&++m,s+=4}return s}var Di={};function fn(u){var s=Di[u];return s===void 0?te(u):s}var Bt=[],dn=[],xi=[null,[],[]];Te=l.BindingError=qe("BindingError"),l.count_emval_handles=function(){for(var u=0,s=5;s<oe.length;++s)oe[s]!==void 0&&++u;return u},l.get_first_emval=function(){for(var u=5;u<oe.length;++u)if(oe[u]!==void 0)return oe[u];return null},_t=l.PureVirtualError=qe("PureVirtualError");for(var mn=Array(256),Ut=0;256>Ut;++Ut)mn[Ut]=String.fromCharCode(Ut);mt=mn,l.getInheritedInstanceCount=function(){return Object.keys(be).length},l.getLiveInheritedInstances=function(){var u,s=[];for(u in be)be.hasOwnProperty(u)&&s.push(be[u]);return s},l.flushPendingDeletes=ar,l.setDelayFunction=function(u){ht=u,pt.length&&ht&&ht(ar)},un=l.InternalError=qe("InternalError"),Me.prototype.isAliasOf=function(u){if(!(this instanceof Me&&u instanceof Me))return!1;var s=this.L.O.M,m=this.L.N,p=u.L.O.M;for(u=u.L.N;s.P;)m=s.aa(m),s=s.P;for(;p.P;)u=p.aa(u),p=p.P;return s===p&&m===u},Me.prototype.clone=function(){if(this.L.N||cr(this),this.L.$)return this.L.count.value+=1,this;var u=je,s=Object,m=s.create,p=Object.getPrototypeOf(this),h=this.L;return u=u(m.call(s,p,{L:{value:{count:h.count,Z:h.Z,$:h.$,N:h.N,O:h.O,S:h.S,T:h.T}}})),u.L.count.value+=1,u.L.Z=!1,u},Me.prototype.delete=function(){this.L.N||cr(this),this.L.Z&&!this.L.$&&I("Object already scheduled for deletion"),Nt(this),on(this.L),this.L.$||(this.L.S=void 0,this.L.N=void 0)},Me.prototype.isDeleted=function(){return!this.L.N},Me.prototype.deleteLater=function(){return this.L.N||cr(this),this.L.Z&&!this.L.$&&I("Object already scheduled for deletion"),pt.push(this),pt.length===1&&ht&&ht(ar),this.L.Z=!0,this},Re.prototype.pa=function(u){return this.ja&&(u=this.ja(u)),u},Re.prototype.ga=function(u){this.V&&this.V(u)},Re.prototype.argPackAdvance=8,Re.prototype.readValueFromPointer=gt,Re.prototype.deleteObject=function(u){u!==null&&u.delete()},Re.prototype.fromWireType=function(u){function s(){return this.ca?Pt(this.M.W,{O:this.va,N:m,T:this,S:u}):Pt(this.M.W,{O:this,N:u})}var m=this.pa(u);if(!m)return this.ga(u),null;var p=be[ir(this.M,m)];if(p!==void 0)return p.L.count.value===0?(p.L.N=m,p.L.S=u,p.clone()):(p=p.clone(),this.ga(u),p);if(!(p=sn[p=this.M.oa(m)]))return s.call(this);p=this.ba?p.ka:p.pointerType;var h=function v(w,b,R){return b===R?w:R.P===void 0||(w=v(w,b,R.P))===null?null:R.ma(w)}(m,this.M,p.M);return h===null?s.call(this):this.ca?Pt(p.M.W,{O:p,N:h,T:this,S:u}):Pt(p.M.W,{O:p,N:h})},ln=l.UnboundTypeError=qe("UnboundTypeError");var Wi={q:function(u,s,m){u=te(u),s=an(s,"wrapper"),m=Q(m);var p=[].slice,h=s.M,v=h.W,w=h.P.W,b=h.P.constructor;for(var R in u=xe(u,function(){h.P.ia.forEach(function(S){if(this[S]===w[S])throw new _t("Pure virtual function "+S+" must be implemented in JavaScript")}.bind(this)),Object.defineProperty(this,"__parent",{value:v}),this.__construct.apply(this,p.call(arguments))}),v.__construct=function(){this===v&&I("Pass correct 'this' to __construct");var S=b.implement.apply(void 0,[this].concat(p.call(arguments)));Nt(S);var L=S.L;S.notifyOnDestruction(),L.$=!0,Object.defineProperties(this,{L:{value:L}}),je(this),S=ir(h,S=L.N),be.hasOwnProperty(S)?I("Tried to register registered instance: "+S):be[S]=this},v.__destruct=function(){this===v&&I("Pass correct 'this' to __destruct"),Nt(this);var S=this.L.N;S=ir(h,S),be.hasOwnProperty(S)?delete be[S]:I("Tried to unregister unregistered instance: "+S)},u.prototype=Object.create(v),m)u.prototype[R]=m[R];return se(u)},l:function(u){var s=Mt[u];delete Mt[u];var m=s.ea,p=s.V,h=s.ha;Pe([u],h.map(v=>v.sa).concat(h.map(v=>v.ya)),v=>{var w={};return h.forEach((b,R)=>{var S=v[R],L=b.qa,G=b.ra,z=v[R+h.length],q=b.xa,X=b.za;w[b.na]={read:Z=>S.fromWireType(L(G,Z)),write:(Z,Ke)=>{var Fe=[];q(X,Z,z.toWireType(Fe,Ke)),sr(Fe)}}}),[{name:s.name,fromWireType:function(b){var R,S={};for(R in w)S[R]=w[R].read(b);return p(b),S},toWireType:function(b,R){for(var S in w)if(!(S in R))throw TypeError('Missing field:  "'+S+'"');var L=m();for(S in w)w[S].write(L,R[S]);return b!==null&&b.push(p,L),L},argPackAdvance:8,readValueFromPointer:gt,U:p}]})},v:function(){},B:function(u,s,m,p,h){var v=ur(m);we(u,{name:s=te(s),fromWireType:function(w){return!!w},toWireType:function(w,b){return b?p:h},argPackAdvance:8,readValueFromPointer:function(w){if(m===1)var b=y;else if(m===2)b=M;else if(m===4)b=B;else throw TypeError("Unknown boolean type size: "+s);return this.fromWireType(b[w>>v])},U:null})},h:function(u,s,m,p,h,v,w,b,R,S,L,G,z){L=te(L),v=pe(h,v),b&&(b=pe(w,b)),S&&(S=pe(R,S)),z=pe(G,z);var q,X=Lt(L);q=function(){It("Cannot construct "+L+" due to unbound types",[p])},l.hasOwnProperty(X)?(I("Cannot register public name '"+X+"' twice"),lr(l,X,X),l.hasOwnProperty(void 0)&&I("Cannot register multiple overloads of a function with the same number of arguments (undefined)!"),l[X].R[void 0]=q):l[X]=q,Pe([u,s,m],p?[p]:[],function(Z){if(Z=Z[0],p)var Ke,Fe=Z.M,vt=Fe.W;else vt=Me.prototype;Z=xe(X,function(){if(Object.getPrototypeOf(this)!==vr)throw new Te("Use 'new' to construct "+L);if($e.X===void 0)throw new Te(L+" has no accessible constructor");var vn=$e.X[arguments.length];if(vn===void 0)throw new Te("Tried to invoke ctor of "+L+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys($e.X).toString()+") parameters instead!");return vn.apply(this,arguments)});var vr=Object.create(vt,{constructor:{value:Z}});Z.prototype=vr;var $e=new Ni(L,Z,vr,z,Fe,v,b,S);Fe=new Re(L,$e,!0,!1),vt=new Re(L+"*",$e,!1,!1);var gn=new Re(L+" const*",$e,!1,!0);return sn[u]={pointerType:vt,ka:gn},Ke=Z,l.hasOwnProperty(X)||Tt("Replacing nonexistant public symbol"),l[X]=Ke,l[X].Y=void 0,[Fe,vt,gn]})},d:function(u,s,m,p,h,v,w){var b=mr(m,p);s=te(s),v=pe(h,v),Pe([],[u],function(R){function S(){It("Cannot call "+L+" due to unbound types",b)}var L=(R=R[0]).name+"."+s;s.startsWith("@@")&&(s=Symbol[s.substring(2)]);var G=R.M.constructor;return G[s]===void 0?(S.Y=m-1,G[s]=S):(lr(G,s,L),G[s].R[m-1]=S),Pe([],b,function(z){return z=dr(L,[z[0],null].concat(z.slice(1)),null,v,w),G[s].R===void 0?(z.Y=m-1,G[s]=z):G[s].R[m-1]=z,[]}),[]})},p:function(u,s,m,p,h,v){0<s||Ne();var w=mr(s,m);h=pe(p,h),Pe([],[u],function(b){var R="constructor "+(b=b[0]).name;if(b.M.X===void 0&&(b.M.X=[]),b.M.X[s-1]!==void 0)throw new Te("Cannot register multiple constructors with identical number of parameters ("+(s-1)+") for class '"+b.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return b.M.X[s-1]=()=>{It("Cannot construct "+b.name+" due to unbound types",w)},Pe([],w,function(S){return S.splice(1,0,null),b.M.X[s-1]=dr(R,S,null,h,v),[]}),[]})},a:function(u,s,m,p,h,v,w,b){var R=mr(m,p);s=te(s),v=pe(h,v),Pe([],[u],function(S){function L(){It("Cannot call "+G+" due to unbound types",R)}var G=(S=S[0]).name+"."+s;s.startsWith("@@")&&(s=Symbol[s.substring(2)]),b&&S.M.ia.push(s);var z=S.M.W,q=z[s];return q===void 0||q.R===void 0&&q.className!==S.name&&q.Y===m-2?(L.Y=m-2,L.className=S.name,z[s]=L):(lr(z,s,G),z[s].R[m-2]=L),Pe([],R,function(X){return X=dr(G,X,S,v,w),z[s].R===void 0?(X.Y=m-2,z[s]=X):z[s].R[m-2]=X,[]}),[]})},A:function(u,s){we(u,{name:s=te(s),fromWireType:function(m){var p=Q(m);return pr(m),p},toWireType:function(m,p){return se(p)},argPackAdvance:8,readValueFromPointer:gt,U:null})},n:function(u,s,m){m=ur(m),we(u,{name:s=te(s),fromWireType:function(p){return p},toWireType:function(p,h){return h},argPackAdvance:8,readValueFromPointer:function(p,h){switch(h){case 2:return function(v){return this.fromWireType(C[v>>2])};case 3:return function(v){return this.fromWireType(U[v>>3])};default:throw TypeError("Unknown float type: "+p)}}(s,m),U:null})},e:function(u,s,m,p,h){s=te(s),h===-1&&(h=4294967295),h=ur(m);var v=b=>b;if(p===0){var w=32-8*m;v=b=>b<<w>>>w}m=s.includes("unsigned")?function(b,R){return R>>>0}:function(b,R){return R},we(u,{name:s,fromWireType:v,toWireType:m,argPackAdvance:8,readValueFromPointer:function(b,R,S){switch(R){case 0:return S?function(L){return y[L]}:function(L){return P[L]};case 1:return S?function(L){return M[L>>1]}:function(L){return H[L>>1]};case 2:return S?function(L){return B[L>>2]}:function(L){return x[L>>2]};default:throw TypeError("Unknown integer type: "+b)}}(s,h,p!==0),U:null})},b:function(u,s,m){function p(v){v>>=2;var w=x;return new h(w.buffer,w[v+1],w[v])}var h=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][s];we(u,{name:m=te(m),fromWireType:p,argPackAdvance:8,readValueFromPointer:p},{ta:!0})},o:function(u,s){var m=(s=te(s))==="std::string";we(u,{name:s,fromWireType:function(p){var h=x[p>>2],v=p+4;if(m)for(var w=v,b=0;b<=h;++b){var R=v+b;if(b==h||P[R]==0){if(w=w?O(P,w,R-w):"",S===void 0)var S=w;else S+="\0"+w;w=R+1}}else{for(b=0,S=Array(h);b<h;++b)S[b]=String.fromCharCode(P[v+b]);S=S.join("")}return Se(p),S},toWireType:function(p,h){h instanceof ArrayBuffer&&(h=new Uint8Array(h));var v,w=typeof h=="string";if(w||h instanceof Uint8Array||h instanceof Uint8ClampedArray||h instanceof Int8Array||I("Cannot pass non-string to std::string"),m&&w){var b=0;for(v=0;v<h.length;++v){var R=h.charCodeAt(v);127>=R?b++:2047>=R?b+=2:55296<=R&&57343>=R?(b+=4,++v):b+=3}v=b}else v=h.length;if(R=(b=gr(4+v+1))+4,x[b>>2]=v,m&&w){if(w=R,R=v+1,v=P,0<R){R=w+R-1;for(var S=0;S<h.length;++S){var L=h.charCodeAt(S);if(55296<=L&&57343>=L&&(L=65536+((1023&L)<<10)|1023&h.charCodeAt(++S)),127>=L){if(w>=R)break;v[w++]=L}else{if(2047>=L){if(w+1>=R)break;v[w++]=192|L>>6}else{if(65535>=L){if(w+2>=R)break;v[w++]=224|L>>12}else{if(w+3>=R)break;v[w++]=240|L>>18,v[w++]=128|L>>12&63}v[w++]=128|L>>6&63}v[w++]=128|63&L}}v[w]=0}}else if(w)for(w=0;w<v;++w)255<(S=h.charCodeAt(w))&&(Se(R),I("String has UTF-16 code units that do not fit in 8 bits")),P[R+w]=S;else for(w=0;w<v;++w)P[R+w]=h[w];return p!==null&&p.push(Se,b),b},argPackAdvance:8,readValueFromPointer:gt,U:function(p){Se(p)}})},k:function(u,s,m){if(m=te(m),s===2)var p=Oi,h=Ci,v=Ii,w=()=>H,b=1;else s===4&&(p=Bi,h=Ui,v=ki,w=()=>x,b=2);we(u,{name:m,fromWireType:function(R){for(var S,L=x[R>>2],G=w(),z=R+4,q=0;q<=L;++q){var X=R+4+q*s;(q==L||G[X>>b]==0)&&(z=p(z,X-z),S===void 0?S=z:S+="\0"+z,z=X+s)}return Se(R),S},toWireType:function(R,S){typeof S!="string"&&I("Cannot pass non-string to C++ string type "+m);var L=v(S),G=gr(4+L+s);return x[G>>2]=L>>b,h(S,G+4,L+s),R!==null&&R.push(Se,G),G},argPackAdvance:8,readValueFromPointer:gt,U:function(R){Se(R)}})},m:function(u,s,m,p,h,v){Mt[u]={name:te(s),ea:pe(m,p),V:pe(h,v),ha:[]}},c:function(u,s,m,p,h,v,w,b,R,S){Mt[u].ha.push({na:te(s),sa:m,qa:pe(p,h),ra:v,ya:w,xa:pe(b,R),za:S})},C:function(u,s){we(u,{ua:!0,name:s=te(s),argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},t:function(u,s,m,p,h){u=Bt[u],s=Q(s),m=fn(m);var v=[];return x[p>>2]=se(v),u(s,m,v,h)},j:function(u,s,m,p){u=Bt[u],u(s=Q(s),m=fn(m),null,p)},f:pr,g:function(u,s){var m,p,h=function(R,S){for(var L=Array(R),G=0;G<R;++G)L[G]=an(x[S+4*G>>2],"parameter "+G);return L}(u,s),v=h[0],w=dn[s=v.name+"_$"+h.slice(1).map(function(R){return R.name}).join("_")+"$"];if(w!==void 0)return w;var b=Array(u-1);return m=(R,S,L,G)=>{for(var z=0,q=0;q<u-1;++q)b[q]=h[q+1].readValueFromPointer(G+z),z+=h[q+1].argPackAdvance;for(q=0,R=R[S].apply(R,b);q<u-1;++q)h[q+1].la&&h[q+1].la(b[q]);if(!v.ua)return v.toWireType(L,R)},p=Bt.length,Bt.push(m),w=p,dn[s]=w},r:function(u){4<u&&(oe[u].fa+=1)},s:function(u){sr(Q(u)),pr(u)},i:function(){Ne("")},x:function(u,s,m){P.copyWithin(u,s,s+m)},w:function(u){var s=P.length;if(2147483648<(u>>>=0))return!1;for(var m=1;4>=m;m*=2){var p=s*(1+.2/m);p=Math.min(p,u+100663296);var h=Math,v=h.min;p=Math.max(u,p),p+=(65536-p%65536)%65536;e:{var w=E.buffer;try{E.grow(v.call(h,2147483648,p)-w.byteLength+65535>>>16),A();var b=1;break e}catch{}b=void 0}if(b)return!0}return!1},z:function(){return 52},u:function(){return 70},y:function(u,s,m,p){for(var h=0,v=0;v<m;v++){var w=x[s>>2],b=x[s+4>>2];s+=8;for(var R=0;R<b;R++){var S=P[w+R],L=xi[u];S===0||S===10?((u===1?o:f)(O(L,0)),L.length=0):L.push(S)}h+=b}return x[p>>2]=h,0}};(function(){function u(h){l.asm=h.exports,E=l.asm.D,A(),T=l.asm.I,j.unshift(l.asm.E),--ne==0&&le&&(h=le,le=null,h())}function s(h){u(h.instance)}function m(h){return(typeof fetch=="function"?fetch(r,{credentials:"same-origin"}).then(function(v){if(!v.ok)throw"failed to load wasm binary file at '"+r+"'";return v.arrayBuffer()}).catch(function(){return Xe()}):Promise.resolve().then(function(){return Xe()})).then(function(v){return WebAssembly.instantiate(v,p)}).then(function(v){return v}).then(h,function(v){f("failed to asynchronously prepare wasm: "+v),Ne(v)})}var p={a:Wi};if(ne++,l.instantiateWasm)try{return l.instantiateWasm(p,u)}catch(h){f("Module.instantiateWasm callback failed with error: "+h),g(h)}(typeof WebAssembly.instantiateStreaming!="function"||At()||typeof fetch!="function"?m(s):fetch(r,{credentials:"same-origin"}).then(function(h){return WebAssembly.instantiateStreaming(h,p).then(s,function(v){return f("wasm streaming compile failed: "+v),f("falling back to ArrayBuffer instantiation"),m(s)})})).catch(g)})();var pn=l.___getTypeName=function(){return(pn=l.___getTypeName=l.asm.F).apply(null,arguments)};function gr(){return(gr=l.asm.H).apply(null,arguments)}function Se(){return(Se=l.asm.J).apply(null,arguments)}function hn(){0<ne||(ft(k),0<ne||n||(n=!0,l.calledRun=!0,_||(ft(j),d(l),ft($))))}return l.__embind_initialize_bindings=function(){return(l.__embind_initialize_bindings=l.asm.G).apply(null,arguments)},l.dynCall_jiji=function(){return(l.dynCall_jiji=l.asm.K).apply(null,arguments)},le=function u(){n||hn(),n||(le=u)},hn(),t.ready}})();async function jc(e){let t=await ms({instantiateWasm(r,n){WebAssembly.instantiate(e,r).then(a=>{a instanceof WebAssembly.Instance?n(a):n(a.instance)})}});return ds(t)}const Ea=new Array(32).fill(void 0);Ea.push(void 0,null,!0,!1);Ea.length;const ps=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});ps.decode();var Pn,Mn,On,Cn,In,Bn,Un,kn,Dn,Nr,xn,Wn;(function(e){e[e.Dynamic=0]="Dynamic",e[e.Fixed=1]="Fixed",e[e.KinematicPositionBased=2]="KinematicPositionBased",e[e.KinematicVelocityBased=3]="KinematicVelocityBased"})(Pn||(Pn={}));(function(e){e[e.Revolute=0]="Revolute",e[e.Fixed=1]="Fixed",e[e.Prismatic=2]="Prismatic",e[e.Spherical=3]="Spherical"})(Mn||(Mn={})),function(e){e[e.AccelerationBased=0]="AccelerationBased",e[e.ForceBased=1]="ForceBased"}(On||(On={}));(function(e){e[e.Average=0]="Average",e[e.Min=1]="Min",e[e.Multiply=2]="Multiply",e[e.Max=3]="Max"})(Cn||(Cn={}));(function(e){e[e.Vertex=0]="Vertex",e[e.Edge=1]="Edge",e[e.Face=2]="Face",e[e.Unknown=3]="Unknown"})(In||(In={}));(function(e){e[e.Ball=0]="Ball",e[e.Cuboid=1]="Cuboid",e[e.Capsule=2]="Capsule",e[e.Segment=3]="Segment",e[e.Polyline=4]="Polyline",e[e.Triangle=5]="Triangle",e[e.TriMesh=6]="TriMesh",e[e.HeightField=7]="HeightField",e[e.ConvexPolyhedron=9]="ConvexPolyhedron",e[e.Cylinder=10]="Cylinder",e[e.Cone=11]="Cone",e[e.RoundCuboid=12]="RoundCuboid",e[e.RoundTriangle=13]="RoundTriangle",e[e.RoundCylinder=14]="RoundCylinder",e[e.RoundCone=15]="RoundCone",e[e.RoundConvexPolyhedron=16]="RoundConvexPolyhedron",e[e.HalfSpace=17]="HalfSpace"})(Bn||(Bn={}));(function(e){e[e.DYNAMIC_DYNAMIC=1]="DYNAMIC_DYNAMIC",e[e.DYNAMIC_KINEMATIC=12]="DYNAMIC_KINEMATIC",e[e.DYNAMIC_FIXED=2]="DYNAMIC_FIXED",e[e.KINEMATIC_KINEMATIC=52224]="KINEMATIC_KINEMATIC",e[e.KINEMATIC_FIXED=8704]="KINEMATIC_FIXED",e[e.FIXED_FIXED=32]="FIXED_FIXED",e[e.DEFAULT=15]="DEFAULT",e[e.ALL=60943]="ALL"})(Un||(Un={}));(function(e){e[e.Density=0]="Density",e[e.Mass=1]="Mass",e[e.MassProps=2]="MassProps"})(kn||(kn={}));(function(e){e[e.EXCLUDE_FIXED=1]="EXCLUDE_FIXED",e[e.EXCLUDE_KINEMATIC=2]="EXCLUDE_KINEMATIC",e[e.EXCLUDE_DYNAMIC=4]="EXCLUDE_DYNAMIC",e[e.EXCLUDE_SENSORS=8]="EXCLUDE_SENSORS",e[e.EXCLUDE_SOLIDS=16]="EXCLUDE_SOLIDS",e[e.ONLY_DYNAMIC=3]="ONLY_DYNAMIC",e[e.ONLY_KINEMATIC=5]="ONLY_KINEMATIC",e[e.ONLY_FIXED=6]="ONLY_FIXED"})(Dn||(Dn={}));(function(e){e[e.COLLISION_EVENTS=1]="COLLISION_EVENTS",e[e.CONTACT_FORCE_EVENTS=2]="CONTACT_FORCE_EVENTS"})(Nr||(Nr={}));(function(e){e[e.FILTER_CONTACT_PAIRS=1]="FILTER_CONTACT_PAIRS",e[e.FILTER_INTERSECTION_PAIRS=2]="FILTER_INTERSECTION_PAIRS"})(xn||(xn={})),function(e){e[e.EMPTY=0]="EMPTY",e[e.COMPUTE_IMPULSE=1]="COMPUTE_IMPULSE"}(Wn||(Wn={}));for(var Yc={byteLength:function(e){var t=Fn(e),r=t[0],n=t[1];return 3*(r+n)/4-n},toByteArray:function(e){var t,r,n=Fn(e),a=n[0],i=n[1],o=new hs(function(d,g,E){return 3*(g+E)/4-E}(0,a,i)),f=0,l=i>0?a-4:a;for(r=0;r<l;r+=4)t=me[e.charCodeAt(r)]<<18|me[e.charCodeAt(r+1)]<<12|me[e.charCodeAt(r+2)]<<6|me[e.charCodeAt(r+3)],o[f++]=t>>16&255,o[f++]=t>>8&255,o[f++]=255&t;return i===2&&(t=me[e.charCodeAt(r)]<<2|me[e.charCodeAt(r+1)]>>4,o[f++]=255&t),i===1&&(t=me[e.charCodeAt(r)]<<10|me[e.charCodeAt(r+1)]<<4|me[e.charCodeAt(r+2)]>>2,o[f++]=t>>8&255,o[f++]=255&t),o},fromByteArray:function(e){for(var t,r=e.length,n=r%3,a=[],i=16383,o=0,f=r-n;o<f;o+=i)a.push(vs(e,o,o+i>f?f:o+i));return n===1?(t=e[r-1],a.push(ye[t>>2]+ye[t<<4&63]+"==")):n===2&&(t=(e[r-2]<<8)+e[r-1],a.push(ye[t>>10]+ye[t>>4&63]+ye[t<<2&63]+"=")),a.join("")}},ye=[],me=[],hs=typeof Uint8Array<"u"?Uint8Array:Array,Sr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Je=0,gs=Sr.length;Je<gs;++Je)ye[Je]=Sr[Je],me[Sr.charCodeAt(Je)]=Je;function Fn(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return r===-1&&(r=t),[r,r===t?0:4-r%4]}function vs(e,t,r){for(var n,a,i=[],o=t;o<r;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(ye[(a=n)>>18&63]+ye[a>>12&63]+ye[a>>6&63]+ye[63&a]);return i.join("")}me["-".charCodeAt(0)]=62,me["_".charCodeAt(0)]=63;function J(e,t){return{mutableScript:(t==null?void 0:t.mutable)!==void 0?t.mutable:e.mutable,script:!1,resourceDef:void 0,backRef:!1,editor:!0,size:1,...e,...t}}function Es(e){return J({type:"bool",arrayType:Uint32Array,mutable:!0,required:!1,default:!1},e)}function ys(e){return J({type:"u32",arrayType:Uint32Array,mutable:!0,required:!1,default:0},e)}function bs(e){return J({type:"i32",arrayType:Int32Array,mutable:!0,required:!1,default:0},e)}function ws(e){return J({type:"f32",arrayType:Float32Array,mutable:!0,required:!1,default:0},e)}function Rs(e){return J({type:"vec2",arrayType:Float32Array,size:2,mutable:!0,required:!1,default:ta()},e)}function Ss(e){return J({type:"vec3",arrayType:Float32Array,size:3,mutable:!0,required:!1,default:wt()},e)}function As(e){return J({type:"vec4",arrayType:Float32Array,size:4,mutable:!0,required:!1,default:kr()},e)}function Ls(e){return J({type:"rgb",arrayType:Float32Array,size:3,mutable:!0,required:!1,default:wt()},e)}function _s(e){return J({type:"rgba",arrayType:Float32Array,size:4,mutable:!0,required:!1,default:kr()},e)}function Ns(e){return J({type:"quat",arrayType:Float32Array,size:4,mutable:!0,required:!1,default:zt()},e)}function Ts(e){return J({type:"mat3",arrayType:Float32Array,size:9,mutable:!0,required:!1,default:Qn()},e)}function Ps(e){return J({type:"mat4",arrayType:Float32Array,size:16,mutable:!0,required:!1,default:Yi()},e)}function Ms(e){return J({type:"bitmask",arrayType:Uint32Array,size:1,mutable:!0,required:!1,default:0},e)}function Os(e,t){return J({type:"enum",arrayType:Uint32Array,mutable:!0,required:!1,default:0,enumType:e},t)}function Cs(e){return J({type:"string",arrayType:Uint32Array,mutable:!0,required:!1,default:""},e)}function Is(e){return J({type:"arrayBuffer",size:3,arrayType:Uint32Array,mutable:!1,required:!0,default:void 0},e)}function Bs(e,t){return J({type:"ref",arrayType:Uint32Array,mutable:!0,required:!1,default:0,resourceDef:e},t)}function Us(e,t){return J({type:"refArray",arrayType:Uint32Array,mutable:!0,required:!1,default:new Uint32Array(t.size),resourceDef:e},t)}function ks(e,t){return J({type:"refMap",arrayType:Uint32Array,mutable:!0,required:!1,default:new Uint32Array(t.size),resourceDef:e},t)}function Ds(e){return J({type:"selfRef",arrayType:Uint32Array,mutable:!0,required:!1,default:0},e)}const c={bool:Es,u32:ys,i32:bs,f32:ws,vec2:Rs,vec3:Ss,vec4:As,rgb:Ls,rgba:_s,quat:Ns,mat3:Ts,mat4:Ps,bitmask:Ms,enum:Os,string:Cs,arrayBuffer:Is,ref:Bs,refArray:Us,refMap:ks,selfRef:Ds},V=(e,t,r)=>{const n={name:e,resourceType:t,schema:r,byteLength:0};let a=0;for(const i in n.schema){const o=n.schema[i];if(o.type==="selfRef"){const f={mutable:o.mutable,mutableScript:o.mutableScript,required:o.required,script:o.script,backRef:o.backRef,editor:o.editor};r[i]=c.ref(n,f),r[i].byteOffset=a}else o.byteOffset=a;a+=o.arrayType.BYTES_PER_ELEMENT*o.size}return n.byteLength=a,n};var ya=(e=>(e[e.Unknown=0]="Unknown",e[e.Nametag=1]="Nametag",e[e.Sampler=2]="Sampler",e[e.Buffer=3]="Buffer",e[e.BufferView=4]="BufferView",e[e.AudioData=5]="AudioData",e[e.AudioSource=6]="AudioSource",e[e.AudioEmitter=7]="AudioEmitter",e[e.Image=8]="Image",e[e.Texture=9]="Texture",e[e.ReflectionProbe=10]="ReflectionProbe",e[e.Material=11]="Material",e[e.Light=12]="Light",e[e.Camera=13]="Camera",e[e.SparseAccessor=14]="SparseAccessor",e[e.Accessor=15]="Accessor",e[e.MeshPrimitive=16]="MeshPrimitive",e[e.InstancedMesh=17]="InstancedMesh",e[e.Mesh=18]="Mesh",e[e.LightMap=19]="LightMap",e[e.TilesRenderer=20]="TilesRenderer",e[e.Skin=21]="Skin",e[e.Interactable=22]="Interactable",e[e.Animation=23]="Animation",e[e.AnimationChannel=24]="AnimationChannel",e[e.AnimationSampler=25]="AnimationSampler",e[e.Node=26]="Node",e[e.Scene=27]="Scene",e[e.World=28]="World",e[e.Avatar=29]="Avatar",e[e.Environment=30]="Environment",e[e.UICanvas=31]="UICanvas",e[e.UIText=32]="UIText",e[e.UIButton=33]="UIButton",e[e.UIImage=34]="UIImage",e[e.UIElement=35]="UIElement",e[e.Collider=36]="Collider",e[e.PhysicsBody=37]="PhysicsBody",e))(ya||{});const ba=V("nametag",1,{name:c.string(),screenX:c.f32(),screenY:c.f32(),distanceFromCamera:c.f32(),inFrustum:c.bool()});var wa=(e=>(e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e))(wa||{}),Ra=(e=>(e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e))(Ra||{}),Tr=(e=>(e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.REPEAT=10497]="REPEAT",e))(Tr||{}),Sa=(e=>(e[e.UVMapping=0]="UVMapping",e[e.CubeReflectionMapping=1]="CubeReflectionMapping",e[e.CubeRefractionMapping=2]="CubeRefractionMapping",e[e.EquirectangularReflectionMapping=3]="EquirectangularReflectionMapping",e[e.EquirectangularRefractionMapping=4]="EquirectangularRefractionMapping",e[e.CubeUVReflectionMapping=5]="CubeUVReflectionMapping",e))(Sa||{});const Aa=V("sampler",2,{name:c.string({default:"Sampler",script:!0}),magFilter:c.enum(wa,{default:9729,script:!0,mutable:!1}),minFilter:c.enum(Ra,{default:9987,script:!0,mutable:!1}),wrapS:c.enum(Tr,{default:10497,script:!0,mutable:!1}),wrapT:c.enum(Tr,{default:10497,script:!0,mutable:!1}),mapping:c.enum(Sa,{default:0,script:!0,mutable:!1})}),La=V("buffer",3,{name:c.string({default:"Buffer",script:!0}),uri:c.string({script:!0,mutable:!1}),data:c.arrayBuffer({script:!0})});var _a=(e=>(e[e.None=0]="None",e[e.ArrayBuffer=34962]="ArrayBuffer",e[e.ElementArrayBuffer=34963]="ElementArrayBuffer",e))(_a||{});const ot=V("buffer-view",4,{name:c.string({default:"BufferView",script:!0}),buffer:c.ref(La,{mutable:!1,required:!0,script:!0}),byteOffset:c.u32({mutable:!1,script:!0}),byteLength:c.u32({mutable:!1,required:!0,script:!0}),byteStride:c.u32({min:4,max:252,mutable:!1,script:!0}),target:c.enum(_a,{default:0,mutable:!1,script:!0})}),Na=V("audio-data",5,{name:c.string({default:"AudioData",script:!0}),bufferView:c.ref(ot,{script:!0,mutable:!1}),mimeType:c.string({script:!0,mutable:!1}),uri:c.string({script:!0,mutable:!1})}),Ta=V("audio-source",6,{name:c.string({default:"AudioSource",script:!0}),audio:c.ref(Na,{script:!0}),gain:c.f32({default:1,min:0,script:!0}),autoPlay:c.bool({default:!1,script:!0,mutable:!1}),loop:c.bool({default:!1,script:!0}),playbackRate:c.f32({default:1})});var qr=(e=>(e[e.Positional=0]="Positional",e[e.Global=1]="Global",e))(qr||{}),st=(e=>(e[e.Environment=0]="Environment",e[e.Music=1]="Music",e[e.Voice=2]="Voice",e))(st||{}),yt=(e=>(e[e.Linear=0]="Linear",e[e.Inverse=1]="Inverse",e[e.Exponential=2]="Exponential",e))(yt||{});const jr=V("audio-emitter",7,{name:c.string({default:"AudioEmitter",script:!0}),type:c.enum(qr,{required:!0,script:!0}),sources:c.refArray(Ta,{size:16,script:!0}),gain:c.f32({default:1,min:0,script:!0}),coneInnerAngle:c.f32({default:Math.PI*2,min:0,max:Math.PI*2,script:!0}),coneOuterAngle:c.f32({default:Math.PI*2,min:0,max:Math.PI*2,script:!0}),coneOuterGain:c.f32({default:0,min:0,max:1}),distanceModel:c.enum(yt,{default:1,script:!0}),maxDistance:c.f32({default:1e4,minExclusive:0,script:!0}),refDistance:c.f32({default:1,min:0,script:!0}),rolloffFactor:c.f32({default:1,min:0,script:!0}),output:c.enum(st,{default:0})}),Yr=V("image",8,{name:c.string({default:"Image",script:!0}),uri:c.string({script:!0,mutable:!1}),mimeType:c.string({script:!0,mutable:!1}),bufferView:c.ref(ot,{script:!0,mutable:!1}),flipY:c.bool({script:!0,mutable:!1})});var Pa=(e=>(e[e.Linear=3e3]="Linear",e[e.sRGB=3001]="sRGB",e))(Pa||{}),Ma=(e=>(e[e.Unknown=0]="Unknown",e[e.Basis=1]="Basis",e))(Ma||{});const ge=V("texture",9,{name:c.string({default:"Texture",script:!0}),sampler:c.ref(Aa,{script:!0,mutable:!1}),source:c.ref(Yr,{script:!0,mutable:!1,required:!0}),rgbm:c.bool({script:!0,mutable:!1}),encoding:c.enum(Pa,{default:3e3,script:!0,mutable:!1}),format:c.enum(Ma,{default:0,script:!0,mutable:!1}),depth:c.u32({default:1,mutable:!1})}),Kr=V("reflection-probe",10,{name:c.string({default:"ReflectionProbe",script:!0}),reflectionProbeTexture:c.ref(ge,{script:!0,mutable:!1}),size:c.vec3({script:!0})});var Oa=(e=>(e[e.OPAQUE=0]="OPAQUE",e[e.MASK=1]="MASK",e[e.BLEND=2]="BLEND",e))(Oa||{}),Ca=(e=>(e[e.Standard=0]="Standard",e[e.Unlit=1]="Unlit",e))(Ca||{});const Ia=V("material",11,{name:c.string({default:"Material",script:!0}),type:c.enum(Ca,{required:!0,script:!0}),doubleSided:c.bool({default:!1,script:!0}),alphaCutoff:c.f32({default:.5,script:!0}),alphaMode:c.enum(Oa,{default:0,script:!0}),baseColorFactor:c.rgba({default:[1,1,1,1],script:!0}),baseColorTexture:c.ref(ge,{script:!0}),baseColorTextureOffset:c.vec2({default:[0,0],mutable:!0}),baseColorTextureRotation:c.f32({default:0,mutable:!0}),baseColorTextureScale:c.vec2({default:[1,1],mutable:!0}),metallicFactor:c.f32({default:1,script:!0}),roughnessFactor:c.f32({default:1,script:!0}),metallicRoughnessTexture:c.ref(ge,{script:!0}),metallicRoughnessTextureOffset:c.vec2({default:[0,0],mutable:!0}),metallicRoughnessTextureRotation:c.f32({default:0,mutable:!0}),metallicRoughnessTextureScale:c.vec2({default:[1,1],mutable:!0}),normalTexture:c.ref(ge,{script:!0}),normalScale:c.f32({default:1,script:!0}),normalTextureOffset:c.vec2({default:[0,0],mutable:!0}),normalTextureRotation:c.f32({default:0,mutable:!0}),normalTextureScale:c.vec2({default:[1,1],mutable:!0}),occlusionTextureStrength:c.f32({default:1,script:!0}),occlusionTexture:c.ref(ge,{script:!0}),occlusionTextureOffset:c.vec2({default:[0,0],mutable:!0}),occlusionTextureRotation:c.f32({default:0,mutable:!0}),occlusionTextureScale:c.vec2({default:[1,1],mutable:!0}),emissiveStrength:c.f32({default:1,script:!0}),emissiveFactor:c.rgb({default:[0,0,0],script:!0}),emissiveTexture:c.ref(ge,{script:!0}),emissiveTextureOffset:c.vec2({default:[0,0],mutable:!0}),emissiveTextureRotation:c.f32({default:0,mutable:!0}),emissiveTextureScale:c.vec2({default:[1,1],mutable:!0}),ior:c.f32({default:1.5,script:!0}),transmissionFactor:c.f32({default:0,script:!0}),transmissionTexture:c.ref(ge,{script:!0}),transmissionTextureOffset:c.vec2({default:[0,0],mutable:!0}),transmissionTextureRotation:c.f32({default:0,mutable:!0}),transmissionTextureScale:c.vec2({default:[1,1],mutable:!0}),thicknessFactor:c.f32({default:0,script:!0}),thicknessTexture:c.ref(ge,{script:!0}),thicknessTextureOffset:c.vec2({default:[0,0],mutable:!0}),thicknessTextureRotation:c.f32({default:0,mutable:!0}),thicknessTextureScale:c.vec2({default:[1,1],mutable:!0}),attenuationDistance:c.f32({default:0,script:!0}),attenuationColor:c.rgb({default:[1,1,1],script:!0})});var Ba=(e=>(e[e.Directional=0]="Directional",e[e.Point=1]="Point",e[e.Spot=2]="Spot",e))(Ba||{});const Ua=V("light",12,{name:c.string({default:"Light",script:!0}),type:c.enum(Ba,{required:!0,script:!0,mutable:!1}),color:c.rgb({default:[1,1,1],script:!0}),intensity:c.f32({default:1,script:!0}),range:c.f32({default:1,script:!0}),innerConeAngle:c.f32({default:1,script:!0}),outerConeAngle:c.f32({default:1,script:!0})});var ka=(e=>(e[e.Perspective=0]="Perspective",e[e.Orthographic=1]="Orthographic",e))(ka||{});const Da=V("camera",13,{name:c.string({default:"Camera",script:!0}),type:c.enum(ka,{script:!0,mutable:!1,required:!0}),layers:c.bitmask({default:1,script:!0}),zfar:c.f32({min:0,script:!0}),znear:c.f32({min:0,script:!0}),xmag:c.f32({minExclusive:0,script:!0}),ymag:c.f32({minExclusive:0,script:!0}),yfov:c.f32({minExclusive:0,script:!0}),aspectRatio:c.f32({min:0,default:0,script:!0}),projectionMatrixNeedsUpdate:c.bool({default:!0,script:!0})});var $r=(e=>(e[e.Int8=5120]="Int8",e[e.Uint8=5121]="Uint8",e[e.Int16=5122]="Int16",e[e.Uint16=5123]="Uint16",e[e.Uint32=5125]="Uint32",e[e.Float32=5126]="Float32",e))($r||{});const xa=V("sparse-accessor",14,{count:c.u32({min:1,mutable:!1,required:!0,script:!0}),indicesBufferView:c.ref(ot,{mutable:!1,required:!0,script:!0}),indicesByteOffset:c.u32({mutable:!1,script:!0}),indicesComponentType:c.enum($r,{mutable:!1,required:!0,script:!0}),valuesBufferView:c.ref(ot,{mutable:!1,required:!0,script:!0}),valuesByteOffset:c.u32({mutable:!1,script:!0})});var Wa=(e=>(e[e.SCALAR=0]="SCALAR",e[e.VEC2=1]="VEC2",e[e.VEC3=2]="VEC3",e[e.VEC4=3]="VEC4",e[e.MAT2=4]="MAT2",e[e.MAT3=5]="MAT3",e[e.MAT4=6]="MAT4",e))(Wa||{});const He=V("accessor",15,{name:c.string({default:"Accessor",script:!0}),bufferView:c.ref(ot,{mutable:!1,script:!0}),byteOffset:c.u32({mutable:!1,script:!0}),componentType:c.enum($r,{mutable:!1,required:!0,script:!0}),normalized:c.bool({mutable:!1,script:!0}),count:c.u32({min:1,mutable:!1,required:!0,script:!0}),type:c.enum(Wa,{mutable:!1,required:!0,script:!0}),max:c.mat4({default:new Float32Array(16),script:!0}),min:c.mat4({default:new Float32Array(16),script:!0}),sparse:c.ref(xa,{mutable:!1,script:!0}),dynamic:c.bool({script:!0,mutable:!1}),version:c.u32({script:!0})});var Fa=(e=>(e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e))(Fa||{}),Ga=(e=>(e[e.POSITION=0]="POSITION",e[e.NORMAL=1]="NORMAL",e[e.TANGENT=2]="TANGENT",e[e.TEXCOORD_0=3]="TEXCOORD_0",e[e.TEXCOORD_1=4]="TEXCOORD_1",e[e.COLOR_0=5]="COLOR_0",e[e.JOINTS_0=6]="JOINTS_0",e[e.WEIGHTS_0=7]="WEIGHTS_0",e))(Ga||{}),Va=(e=>(e[e.TRANSLATION=0]="TRANSLATION",e[e.ROTATION=1]="ROTATION",e[e.SCALE=2]="SCALE",e[e.LIGHTMAP_OFFSET=3]="LIGHTMAP_OFFSET",e[e.LIGHTMAP_SCALE=4]="LIGHTMAP_SCALE",e))(Va||{});const za=V("mesh-primitive",16,{attributes:c.refMap(He,{size:Object.values(Ga).filter(e=>typeof e=="number").length,mutable:!1,required:!0,script:!0}),indices:c.ref(He,{mutable:!1,script:!0}),material:c.ref(Ia,{script:!0}),mode:c.enum(Fa,{default:4,script:!0,mutable:!1}),drawStart:c.u32({script:!0,mutable:!0}),drawCount:c.u32({script:!0,mutable:!0}),hologramMaterialEnabled:c.bool({script:!0})}),Ha=V("instanced-mesh",17,{name:c.string({default:"InstancedMesh",script:!0}),attributes:c.refMap(He,{size:Object.values(Va).filter(e=>typeof e=="number").length,mutable:!1,required:!0,script:!0})}),Jr=V("mesh",18,{name:c.string({default:"Mesh",script:!0}),primitives:c.refArray(za,{size:16,script:!0,mutable:!1})}),Xa=V("light-map",19,{name:c.string({default:"LightMap",script:!0}),texture:c.ref(ge,{mutable:!1,required:!0,script:!0}),offset:c.vec2({default:[0,0],script:!0,mutable:!1}),scale:c.vec2({default:[0,0],script:!0,mutable:!1}),intensity:c.f32({default:1,script:!0,mutable:!1})}),qa=V("tiles-renderer",20,{uri:c.string({mutable:!1,required:!0,script:!0})}),ja=V("skin",21,{name:c.string({default:"Skin",script:!0}),joints:c.refArray("node",{size:128,script:!0,mutable:!1}),inverseBindMatrices:c.ref(He,{script:!0})});var Ya=(e=>(e[e.Interactable=1]="Interactable",e[e.Grabbable=2]="Grabbable",e[e.Player=3]="Player",e[e.Portal=4]="Portal",e[e.UI=5]="UI",e))(Ya||{});const Zr=V("interactable",22,{type:c.enum(Ya,{required:!0,mutable:!1,default:1,script:!0}),pressed:c.bool({mutableScript:!1,script:!0}),held:c.bool({mutableScript:!1,script:!0}),released:c.bool({mutableScript:!1,script:!0})});var Ka=(e=>(e[e.Flex=0]="Flex",e[e.Text=1]="Text",e[e.Button=2]="Button",e[e.Image=3]="Image",e))(Ka||{}),Pr=(e=>(e[e.Column=Jo]="Column",e[e.ColumnReverse=Zo]="ColumnReverse",e[e.Row=Qo]="Row",e[e.RowReverse=es]="RowReverse",e))(Pr||{}),Mr=(e=>(e[e.Relative=ss]="Relative",e[e.Absolute=us]="Absolute",e))(Mr||{}),Ge=(e=>(e[e.Auto=Wo]="Auto",e[e.FlexStart=Fo]="FlexStart",e[e.Center=Go]="Center",e[e.FlexEnd=Vo]="FlexEnd",e[e.Stretch=zo]="Stretch",e[e.Baseline=Ho]="Baseline",e[e.SpaceBetween=Xo]="SpaceBetween",e[e.SpaceAround=qo]="SpaceAround",e))(Ge||{}),Or=(e=>(e[e.FlexStart=ts]="FlexStart",e[e.Center=rs]="Center",e[e.FlexEnd=ns]="FlexEnd",e[e.SpaceBetween=as]="SpaceBetween",e[e.SpaceAround=is]="SpaceAround",e[e.SpaceEvenly=os]="SpaceEvenly",e))(Or||{}),Cr=(e=>(e[e.NoWrap=cs]="NoWrap",e[e.Wrap=ls]="Wrap",e[e.WrapReverse=fs]="WrapReverse",e))(Cr||{}),xs=(e=>(e[e.LEFT=jo]="LEFT",e[e.TOP=Yo]="TOP",e[e.RIGHT=Ko]="RIGHT",e[e.BOTTOM=$o]="BOTTOM",e))(xs||{});const $a=V("ui-text",32,{value:c.string({script:!0}),fontFamily:c.string({script:!0}),fontSize:c.f32({default:12,script:!0}),fontWeight:c.string({script:!0}),fontStyle:c.string({script:!0}),color:c.rgba({script:!0})}),Ja=V("ui-button",33,{interactable:c.ref(Zr,{script:!0}),label:c.string({script:!0})}),Za=V("ui-image",34,{source:c.ref(Yr,{script:!0}),alt:c.string({script:!0,required:!1})}),Qa=V("ui-element",35,{name:c.string({default:"UIElement",script:!0}),type:c.enum(Ka,{default:0,mutable:!1}),position:c.vec4({script:!0,mutable:!0}),positionType:c.enum(Mr,{default:Mr.Relative,script:!0,mutable:!0}),alignContent:c.enum(Ge,{default:Ge.FlexStart,script:!0,mutable:!0}),alignItems:c.enum(Ge,{default:Ge.Stretch,script:!0,mutable:!0}),alignSelf:c.enum(Ge,{default:Ge.Auto,script:!0,mutable:!0}),flexDirection:c.enum(Pr,{default:Pr.Row,script:!0,mutable:!0}),flexWrap:c.enum(Cr,{default:Cr.NoWrap,script:!0,mutable:!0}),flexBasis:c.f32({default:-1,script:!0,mutable:!0}),flexGrow:c.f32({script:!0,mutable:!0,min:0}),flexShrink:c.f32({default:1,script:!0,mutable:!0,min:0}),justifyContent:c.enum(Or,{default:Or.FlexStart,script:!0,mutable:!0}),width:c.f32({default:-1,script:!0,mutable:!0}),height:c.f32({default:-1,script:!0,mutable:!0}),minWidth:c.f32({default:-1,script:!0,mutable:!0}),minHeight:c.f32({default:-1,script:!0,mutable:!0}),maxWidth:c.f32({default:-1,script:!0,mutable:!0}),maxHeight:c.f32({default:-1,script:!0,mutable:!0}),backgroundColor:c.rgba({script:!0,mutable:!0}),borderColor:c.rgba({script:!0,mutable:!0}),padding:c.vec4({script:!0,mutable:!0}),margin:c.vec4({script:!0,mutable:!0}),borderWidth:c.vec4({script:!0,mutable:!0}),borderRadius:c.vec4({script:!0,mutable:!0}),parent:c.selfRef({backRef:!0}),firstChild:c.selfRef(),prevSibling:c.selfRef({backRef:!0}),nextSibling:c.selfRef(),text:c.ref($a,{mutable:!1}),button:c.ref(Ja,{mutable:!1}),image:c.ref(Za,{mutable:!1})}),ei=V("ui-canvas",31,{name:c.string({default:"UICanvas",script:!0}),root:c.ref(Qa),size:c.vec2({script:!0,mutable:!0}),width:c.f32({script:!0,mutable:!0}),height:c.f32({script:!0,mutable:!0}),redraw:c.u32({default:1,script:!0,mutable:!0})});var ti=(e=>(e[e.Box=0]="Box",e[e.Sphere=1]="Sphere",e[e.Capsule=2]="Capsule",e[e.Cylinder=3]="Cylinder",e[e.Hull=4]="Hull",e[e.Trimesh=5]="Trimesh",e))(ti||{});const ri=V("collider",36,{name:c.string({default:"Collider",script:!0}),type:c.enum(ti,{required:!0,mutable:!1}),activeEvents:c.enum(Nr,{default:0,mutable:!1}),collisionGroups:c.u32({mutable:!1}),offset:c.vec3({mutable:!1}),restitution:c.f32({mutable:!1}),density:c.f32({mutable:!1}),isTrigger:c.bool({mutable:!1}),size:c.vec3({mutable:!1}),radius:c.f32({mutable:!1}),height:c.f32({mutable:!1}),mesh:c.ref(Jr,{mutable:!1})});var ni=(e=>(e[e.Static=0]="Static",e[e.Kinematic=1]="Kinematic",e[e.Rigid=2]="Rigid",e))(ni||{});const ai=V("physics-body",37,{type:c.enum(ni,{required:!0,mutable:!1}),mass:c.f32({min:0}),linearVelocity:c.vec3(),angularVelocity:c.vec3(),inertiaTensor:c.mat3()}),Ie=V("node",26,{name:c.string({default:"Node",script:!0}),parentScene:c.ref("scene",{backRef:!0,editor:!1}),parent:c.selfRef({backRef:!0,editor:!1}),firstChild:c.selfRef({editor:!1}),prevSibling:c.selfRef({backRef:!0,editor:!1}),nextSibling:c.selfRef({editor:!1}),position:c.vec3({script:!0}),quaternion:c.quat({script:!0}),scale:c.vec3({script:!0,default:[1,1,1]}),localMatrix:c.mat4({script:!0,editor:!1}),worldMatrix:c.mat4({script:!0,editor:!1}),worldMatrixNeedsUpdate:c.bool({script:!0,default:!0}),visible:c.bool({script:!0,default:!0}),enabled:c.bool({script:!0,default:!0}),skipLerp:c.i32({script:!0,default:10,editor:!1}),isStatic:c.bool({script:!0,default:!1}),layers:c.bitmask({default:1,script:!0}),mesh:c.ref(Jr,{script:!0}),instancedMesh:c.ref(Ha,{script:!0}),lightMap:c.ref(Xa,{script:!0}),skin:c.ref(ja,{script:!0}),light:c.ref(Ua,{script:!0}),reflectionProbe:c.ref(Kr,{script:!0}),camera:c.ref(Da,{script:!0}),audioEmitter:c.ref(jr,{script:!0}),tilesRenderer:c.ref(qa,{script:!0}),nametag:c.ref(ba,{script:!1}),interactable:c.ref(Zr,{script:!0}),uiCanvas:c.ref(ei,{script:!0}),collider:c.ref(ri,{script:!0}),physicsBody:c.ref(ai,{script:!0}),castShadow:c.bool({default:!0,script:!0}),receiveShadow:c.bool({default:!0,script:!0})});var ii=(e=>(e[e.LINEAR=0]="LINEAR",e[e.STEP=1]="STEP",e[e.CUBICSPLINE=2]="CUBICSPLINE",e))(ii||{});const Qr=V("animation-sampler",25,{input:c.ref(He,{script:!0,mutable:!1,required:!0}),interpolation:c.enum(ii,{script:!0,mutable:!1,default:0}),output:c.ref(He,{script:!0,mutable:!1,required:!0})});var oi=(e=>(e[e.Translation=0]="Translation",e[e.Rotation=1]="Rotation",e[e.Scale=2]="Scale",e[e.Weights=3]="Weights",e))(oi||{});const si=V("animation-channel",24,{sampler:c.ref(Qr,{script:!0,mutable:!1}),targetNode:c.ref(Ie,{required:!0}),targetPath:c.enum(oi,{required:!0})}),Ws=V("animation",23,{name:c.string({default:"Animation",script:!0}),channels:c.refArray(si,{size:256,script:!0,required:!0,mutable:!1}),samplers:c.refArray(Qr,{size:256,script:!0,required:!0,mutable:!1})}),qt=V("scene",27,{name:c.string({default:"Scene",script:!0}),backgroundTexture:c.ref(ge,{script:!0}),reflectionProbe:c.ref(Kr,{script:!0}),bloomStrength:c.f32({script:!0,default:.1}),bloomThreshold:c.f32({script:!0,default:.9}),bloomRadius:c.f32({script:!0,default:.4}),audioEmitters:c.refArray(jr,{size:16,script:!0}),firstNode:c.ref(Ie,{script:!1}),supportsAR:c.bool({script:!0,mutable:!1})}),ui=V("environment",30,{publicScene:c.ref(qt,{script:!0,required:!0,mutable:!0}),privateScene:c.ref(qt,{script:!1,required:!0,mutable:!1})}),Fs=V("world",28,{environment:c.ref(ui,{script:!1}),firstNode:c.ref(Ie),persistentScene:c.ref(qt,{required:!0,script:!1}),activeCameraNode:c.ref(Ie,{script:!1}),activeAvatarNode:c.ref(Ie,{script:!1}),activeLeftControllerNode:c.ref(Ie,{script:!1}),activeRightControllerNode:c.ref(Ie,{script:!1})});class jt extends F(ba){load(t){const r=W(t,Ee),n=ke(t,jt);r.eventEmitter.emit("nametags-changed",[...n,this])}dispose(t){super.dispose(t);const r=W(t,Ee),n=ke(t,jt);r.eventEmitter.emit("nametags-changed",[...n])}}class Gs extends F(Aa){}class Vs extends F(La){}class zs extends F(ot){}class ci extends F(Na){constructor(){super(...arguments);K(this,"data");K(this,"loadStatus",Ae.Uninitialized);K(this,"abortController")}dispose(){this.loadStatus=Ae.Disposed,this.abortController&&this.abortController.abort()}}class li extends F(Ta){constructor(){super(...arguments);K(this,"activeAudioDataResourceId",0);K(this,"sourceNode");K(this,"gainNode");K(this,"canAutoPlay",!0)}dispose(){this.gainNode&&this.gainNode.disconnect(),this.sourceNode&&this.sourceNode.disconnect()}}class fi extends F(jr){constructor(){super(...arguments);K(this,"activeSources",[]);K(this,"inputGain");K(this,"outputGain");K(this,"destination")}load(r){const n=W(r,Ee),a=n.context;this.inputGain=a.createGain(),this.outputGain=a.createGain();const i=this.output===st.Voice?n.voiceGain:this.output===st.Music?n.musicGain:n.environmentGain;this.outputGain.connect(i),this.destination=i,this.type===qr.Global&&this.inputGain.connect(this.outputGain)}dispose(){this.inputGain&&this.inputGain.disconnect(),this.outputGain&&this.outputGain.disconnect()}}class Hs extends F(Yr){}class Xs extends F(ge){}class qs extends F(Kr){}class js extends F(Ia){}class Ys extends F(Ua){}class Ks extends F(Da){}class $s extends F(xa){}class Js extends F(He){}class Zs extends F(za){}class Qs extends F(Ha){}class eu extends F(Jr){}class tu extends F(Xa){}class ru extends F(qa){}class nu extends F(ja){}class au extends F(Zr){}class iu extends F($a){}class ou extends F(Ja){}class su extends F(Za){constructor(){super(...arguments);K(this,"domElement")}}class uu extends F(Qa){constructor(){super(...arguments);K(this,"yogaNode")}}class cu extends F(ei){constructor(){super(...arguments);K(this,"canvasTexture");K(this,"canvas");K(this,"yogaNode")}}class lu extends F(ri){}class fu extends F(ai){}class tr extends F(Ie){constructor(){super(...arguments);K(this,"currentAudioEmitterResourceId",0);K(this,"emitterInputNode");K(this,"emitterPannerNode");K(this,"emitterOutput")}dispose(){if(this.emitterPannerNode){if(this.emitterInputNode)try{this.emitterInputNode.disconnect(this.emitterPannerNode)}catch{}this.emitterPannerNode.disconnect()}}}class du extends F(Qr){}class mu extends F(si){}class pu extends F(Ws){}class hu extends F(qt){}class gu extends F(ui){}class di extends F(Fs){}const{ResourceModule:vu,getLocalResource:Eu,getLocalResources:ke,registerResource:Kc,registerResourceLoader:$c,ResourceLoaderSystem:mi,ReturnRecycledResourcesSystem:yu}=xo([tr,ou,cu,uu,su,iu,ci,li,fi,jt,Ys,Gs,Ks,Vs,zs,Hs,js,Xs,eu,hu,Zs,au,lu,fu,Js,$s,nu,Qs,tu,qs,ru,mu,du,pu,gu,di]);function bu(e,t=0,r){const n=new Uint8Array(e,t,r),a=new ArrayBuffer(r||e.byteLength);return new Uint8Array(a).set(n),a}var et=(e=>(e[e.Play=0]="Play",e[e.PlayOneShot=1]="PlayOneShot",e[e.Pause=2]="Pause",e[e.Stop=3]="Stop",e[e.Seek=4]="Seek",e))(et||{});const wu=6,Gn=wu*Float32Array.BYTES_PER_ELEMENT;function Ru(e=1e3){const t=Wr(Float32Array,e*Gn),r=new ArrayBuffer(Gn),n=new Uint8Array(r),a=er(r);return Object.assign(t,{buffer:r,array:n,view:a})}const Su=()=>({action:0,audioSourceId:0,tick:0,playbackRate:1,gain:1,time:0});function Au(e,t){if(da(e))return!1;Vr(e,e.array);const{view:r}=e;return ct(r,0),t.action=at(r),t.audioSourceId=at(r),t.tick=at(r),t.gain=Rr(r),t.playbackRate=Rr(r),t.time=Rr(r),Lo(r)}const pi=2**8,Yt=pi/2;var hi=(e=>(e.InitializeAudioState="initialize-audio-state",e))(hi||{});const Lu={frequencyData:[Uint8Array,Yt],timeData:[Uint8Array,Yt]},Dt=new Float32Array(3);function gi(e,t){Ki(Dt,t);const r=1/Dt[0],n=1/Dt[1],a=1/Dt[2],i=t[0]*r,o=t[1]*n,f=t[2]*a,l=t[4]*r,d=t[5]*n,g=t[6]*a,E=t[8]*r,_=t[9]*n,O=t[10]*a,A=i+d+O;let y=0;return A>0?(y=Math.sqrt(A+1)*2,e[3]=.25*y,e[0]=(g-_)/y,e[1]=(E-f)/y,e[2]=(o-l)/y):i>d&&i>O?(y=Math.sqrt(1+i-d-O)*2,e[3]=(g-_)/y,e[0]=.25*y,e[1]=(o+l)/y,e[2]=(E+f)/y):d>O?(y=Math.sqrt(1+d-i-O)*2,e[3]=(E-f)/y,e[0]=(o+l)/y,e[1]=.25*y,e[2]=(g+_)/y):(y=Math.sqrt(1+O-i-d)*2,e[3]=(o-l)/y,e[0]=(E+f)/y,e[1]=(g+_)/y,e[2]=.25*y),e}const Ee={name:"audio",async create(e,{sendMessage:t}){const r=new AudioContext,n=new AnalyserNode(r);n.fftSize=pi;const a=ga(Lu,e.mainToGameTripleBufferFlags),i=new DynamicsCompressorNode(r);i.threshold.value=-.2,i.knee.value=0,i.ratio.value=20,i.attack.value=5e-4,i.release.value=.02,i.connect(r.destination);const o=new GainNode(r);o.connect(i);const f=new GainNode(r);f.connect(o);const l=new GainNode(r);l.connect(o);const d=new GainNode(r);d.connect(o);const g=Ru();return t(D.Game,hi.InitializeAudioState,{audioPlaybackRingBuffer:g,analyserTripleBuffer:a}),{context:r,analyser:n,analyserTripleBuffer:a,mainLimiter:i,mainGain:o,environmentGain:f,voiceGain:l,musicGain:d,mediaStreams:new Map,localMediaStream:void 0,scenes:[],eventEmitter:new la,audioPlaybackRingBuffer:g,audioPlaybackQueue:[],oneShotCount:0}},init(e){const t=W(e,Ee);return()=>{t.context.close()}}};function _u(e){const t=W(e,Ee);Iu(e,t),Bu(e,t),Uu(e,t),Fu(e,t),Cu(e,t),Nu(e,t)}const Vn=new Uint8Array(Yt),zn=new Uint8Array(Yt);function Nu(e,t){const r=va(t.analyserTripleBuffer);t.analyser.getByteFrequencyData(Vn),t.analyser.getByteTimeDomainData(zn),r.frequencyData.set(Vn),r.timeData.set(zn)}const Tu=64e4,Pu={mp3:"audio/mpeg",aac:"audio/mpeg",opus:"audio/ogg",ogg:"audio/ogg",wav:"audio/wav",flac:"audio/flac",mp4:"audio/mp4",webm:"audio/webm"};function Mu(e){const t=e.split(".").pop()||"";return Pu[t]||"audio/mpeg"}async function Ou(e,t,r){let n,a;if(t.bufferView)n=bu(t.bufferView.buffer.data,t.bufferView.byteOffset,t.bufferView.byteLength),a=t.mimeType;else{const i=new URL(t.uri,window.location.href);if(i.protocol==="mediastream:")return e.mediaStreams.get(i.pathname);const o=await fetch(i.href,{signal:r}),f=o.headers.get("Content-Type");f?a=f:a=Mu(t.uri),n=await o.arrayBuffer()}if(n.byteLength>Tu){const i=URL.createObjectURL(new Blob([n],{type:a})),o=new Audio;return await new Promise((f,l)=>{o.oncanplaythrough=f,o.onerror=l,o.src=i}),o}else return e.context.decodeAudioData(n)}function Cu(e,t){var n;const r=ke(e,tr);for(let a=0;a<r.length;a++){const i=r[a];if(zu(e,t,i),i===e.worldResource.activeCameraNode){const o=(n=e.singleConsumerThreadSharedState)!=null&&n.useXRViewerWorldMatrix?e.singleConsumerThreadSharedState.xrViewerWorldMatrix:i.worldMatrix;Gu(e,t,o)}}}function Iu(e,t){const r=ke(e,ci);for(let n=0;n<r.length;n++){const a=r[n];if(a.loadStatus===Ae.Uninitialized){const i=new AbortController;a.abortController=i,a.loadStatus=Ae.Loading;const o=a;Ou(t,o,i.signal).then(f=>{if(o.loadStatus===Ae.Loaded)throw new Error("Attempted to load a resource that has already been loaded.");o.loadStatus!==Ae.Disposed&&(o.data=f,o.loadStatus=Ae.Loaded)}).catch(f=>{f.name!=="AbortError"&&(o.loadStatus=Ae.Error)})}}}function Bu(e,t){var n;const r=ke(e,li);for(let a=0;a<r.length;a++){const i=r[a],o=i.activeAudioDataResourceId,f=((n=i.audio)==null?void 0:n.eid)||0;if(o!==f&&i.sourceNode&&(i.sourceNode.disconnect(),i.sourceNode=void 0),!i.audio)continue;const l=i.audio.data;i.activeAudioDataResourceId=f;let d=i.gainNode;if(d||(d=t.context.createGain(),i.gainNode=d),d.gain.value=i.gain,l instanceof MediaStream)i.sourceNode||(i.sourceNode=t.context.createMediaStreamSource(l),i.sourceNode.connect(d),i.canAutoPlay=!1);else if(l instanceof AudioBuffer){const g=i.sourceNode;i.autoPlay&&i.canAutoPlay?Ir(t,i,d,l,0):g&&(g.loop=i.loop,g.playbackRate.value=i.playbackRate)}else if(l instanceof HTMLAudioElement){if(!i.sourceNode){const _=l.cloneNode();i.sourceNode=t.context.createMediaElementSource(_),i.sourceNode.connect(d)}const E=i.sourceNode.mediaElement;E.playbackRate!==i.playbackRate&&(E.playbackRate=i.playbackRate),E.loop!==i.loop&&(E.loop=i.loop),i.autoPlay&&i.canAutoPlay&&Ir(t,i,d,l,0)}}}function Uu(e,t){var a;const{audioPlaybackRingBuffer:r,audioPlaybackQueue:n}=t;for(;Xt(r);){const i=Su();Au(r,i),n.push(i)}for(let i=0;i<n.length;i++){const o=n[i];if(o.tick>=e.tick){const f=Eu(e,o.audioSourceId),l=f==null?void 0:f.gainNode;if(!f||!l){console.warn("One shot audio source not loaded yet.");continue}const d=(a=f.audio)==null?void 0:a.data;if(!d){console.warn("Audio data not loaded yet.");continue}if(d instanceof MediaStream)console.warn("MediaStream audio sources cannot be controlled.");else switch(o.action){case et.Play:Ir(t,f,l,d,o.time);break;case et.PlayOneShot:ku(t,l,d,o.gain,o.playbackRate);break;case et.Pause:Du(f,d);break;case et.Seek:xu(f,d,o.time);break;case et.Stop:Wu(f,d);break}n.splice(i,1),i--}}}function Ir(e,t,r,n,a){if(n instanceof AudioBuffer){let i=t.sourceNode;i&&(i.stop(),i.disconnect()),i=e.context.createBufferSource(),i.connect(r),i.buffer=n,i.loop=t.loop,i.playbackRate.value=t.playbackRate,i.start(0,a),t.sourceNode=i}else{const o=t.sourceNode.mediaElement;n.currentTime=a,o.play()}t.canAutoPlay=!1}function ku(e,t,r,n,a){if(r instanceof AudioBuffer){const i=e.context.createBufferSource();i.buffer=r,i.playbackRate.value=a;let o;n!==1?(o=e.context.createGain(),o.gain.value=n,i.connect(o),o.connect(t)):i.connect(t),i.onended=()=>{o==null||o.disconnect(),i.disconnect(),e.oneShotCount--},i.start(),e.oneShotCount++}else console.warn("Invalid one shot audio source.")}function Du(e,t){if(t instanceof AudioBuffer){const r=e.sourceNode;r&&r.stop()}else e.sourceNode.mediaElement.pause();e.canAutoPlay=!1}function xu(e,t,r){if(t instanceof AudioBuffer){const n=e.sourceNode;n&&n.start(0,r)}else{const a=e.sourceNode.mediaElement;a.currentTime=r}}function Wu(e,t){if(t instanceof AudioBuffer){const r=e.sourceNode;r&&(r.stop(),r.disconnect(),e.sourceNode=void 0)}else{const n=e.sourceNode.mediaElement;n.currentTime=0,n.pause()}e.canAutoPlay=!1}function Hn(e,t){for(let r=0;r<e.length;r++){const n=e[r];if(n.eid===t)return n}}function Fu(e,t){const r=ke(e,fi);for(let n=0;n<r.length;n++){const a=r[n],i=a.activeSources,o=a.sources;for(let l=i.length-1;l>=0;l--){const d=i[l];if(!Hn(o,d.eid)){try{d.gainNode.disconnect(a.inputGain)}catch{}i.splice(l,1)}}for(let l=0;l<o.length;l++){const d=o[l];Hn(i,d.eid)||(i.push(d),d.gainNode.connect(a.inputGain))}a.outputGain.gain.value=a.gain;const f=a.output===st.Voice?t.voiceGain:a.output===st.Music?t.musicGain:t.environmentGain;a.destination!==f&&(a.outputGain.disconnect(),a.outputGain.connect(f),a.destination=f)}}const re=wt(),Kt=zt(),ee=wt(),Ze=Lr(0,1,0);function Gu(e,t,r){if(Kn(re,r),isNaN(re[0]))return;gi(Kt,r),$n(ee,0,0,-1),Jn(ee,ee,Kt);const n=t.context.listener;if(n.positionX){const i=t.context.currentTime+e.dt;n.positionX.linearRampToValueAtTime(re[0],i),n.positionY.linearRampToValueAtTime(re[1],i),n.positionZ.linearRampToValueAtTime(re[2],i),n.forwardX.linearRampToValueAtTime(ee[0],i),n.forwardY.linearRampToValueAtTime(ee[1],i),n.forwardZ.linearRampToValueAtTime(ee[2],i),n.upX.linearRampToValueAtTime(Ze[0],i),n.upY.linearRampToValueAtTime(Ze[1],i),n.upZ.linearRampToValueAtTime(Ze[2],i)}else n.setPosition(re[0],re[1],re[2]),n.setOrientation(ee[0],ee[1],ee[2],Ze[0],Ze[1],Ze[2])}const Vu={[yt.Linear]:"linear",[yt.Inverse]:"inverse",[yt.Exponential]:"exponential"},Xn=180/Math.PI;function zu(e,t,r){var f;const n=r.currentAudioEmitterResourceId,a=((f=r.audioEmitter)==null?void 0:f.eid)||0;if(n!==a&&r.emitterInputNode&&r.emitterPannerNode){try{r.emitterInputNode.disconnect(r.emitterPannerNode)}catch{}r.emitterPannerNode.disconnect(),r.emitterInputNode=void 0,r.emitterPannerNode=void 0}if(r.currentAudioEmitterResourceId=a,!r.audioEmitter)return;r.emitterPannerNode||(r.emitterPannerNode=t.context.createPanner(),r.emitterPannerNode.panningModel="HRTF",r.audioEmitter.inputGain.connect(r.emitterPannerNode),r.emitterPannerNode.connect(r.audioEmitter.outputGain),r.emitterInputNode=r.audioEmitter.inputGain);const i=r.emitterPannerNode,o=r.audioEmitter;if(Kn(re,r.worldMatrix),!isNaN(re[0])){if(gi(Kt,r.worldMatrix),$n(ee,0,0,-1),Jn(ee,ee,Kt),i.positionX){const l=t.context.currentTime+e.dt;i.positionX.linearRampToValueAtTime(re[0],l),i.positionY.linearRampToValueAtTime(re[1],l),i.positionZ.linearRampToValueAtTime(re[2],l),i.orientationX.linearRampToValueAtTime(ee[0],l),i.orientationY.linearRampToValueAtTime(ee[0],l),i.orientationZ.linearRampToValueAtTime(ee[0],l)}else i.setPosition(re[0],re[1],re[2]),i.setOrientation(ee[0],ee[1],ee[2]);i.coneInnerAngle=o.coneInnerAngle*Xn,i.coneOuterAngle=o.coneOuterAngle*Xn,i.coneOuterGain=o.coneOuterGain,i.distanceModel=Vu[o.distanceModel],i.maxDistance=o.maxDistance,i.refDistance=o.refDistance,i.rolloffFactor=o.rolloffFactor}}const Hu=/Chrome/.test(navigator.userAgent),vi=(e,t,r)=>{if(!r){e.mediaStreams.delete(t);return}if(Hu){const n=new Audio;n.srcObject=r,n.setAttribute("autoplay","autoplay"),n.muted=!0}console.log("adding mediastream for peer",t),e.mediaStreams.set(t,r)};function Jc(e,t){const r=W(e,Ee);if(t){if(r.localMediaStreamSource)throw new Error("Local media stream source already connected.");r.localMediaStreamSource=r.context.createMediaStreamSource(t),r.localMediaStreamSource.connect(r.analyser)}else r.localMediaStreamSource&&(r.localMediaStreamSource.disconnect(r.analyser),r.localMediaStreamSource=void 0)}var ie=(e=>(e.InitializeEditorState="init-editor-state",e.LoadEditor="load-editor",e.EditorLoaded="editor-loaded",e.DisposeEditor="dispose-editor",e.SelectionChanged="selection-changed",e.ToggleSelectedEntity="toggle-selected-entity",e.SetSelectedEntity="set-selected-entity",e.AddSelectedEntity="add-selected-entity",e.FocusEntity="focus-entity",e.RenameEntity="rename-entity",e.ReparentEntities="reparent-entities",e.SetProperty="set-property",e.SetRefProperty="set-ref-property",e.SetRefArrayProperty="set-ref-array-property",e))(ie||{}),Xu=(e=>(e.EditorLoaded="editor-loaded",e.HierarchyChanged="hierarchy-changed",e.SelectionChanged="selection-changed",e))(Xu||{});const lt={name:"editor",async create(e,{waitForMessage:t}){const{editorStateTripleBuffer:r}=await t(D.Game,ie.InitializeEditorState);return{activeEntity:pa,selectedEntities:[],editorStateTripleBuffer:r,eventEmitter:new la,editorLoaded:!1}},init(e){return _e([ce(e,ie.EditorLoaded,Yu),ce(e,ie.SelectionChanged,Ku)])}};function qu(e){const t=W(e,lt);t.editorLoaded&&ju(e,t)}function ju(e,t){var a;const r=(a=e.worldResource.environment)==null?void 0:a.publicScene,n={scene:r&&Ei(r),activeEntity:t.activeEntity,selectedEntities:t.selectedEntities};t.eventEmitter.emit("hierarchy-changed",n)}function Yu(e,t){const r=W(e,lt);r.editorLoaded=!0,r.selectedEntities=t.selectedEntities,r.activeEntity=t.activeEntity;const n={selectedEntities:t.selectedEntities,activeEntity:t.activeEntity};r.eventEmitter.emit("editor-loaded",n)}function Ku(e,t){const r=W(e,lt);r.selectedEntities=t.selectedEntities,r.activeEntity=t.activeEntity;const n={selectedEntities:t.selectedEntities,activeEntity:t.activeEntity};r.eventEmitter.emit("selection-changed",n)}function Zc(e){e.sendMessage(D.Game,{type:ie.LoadEditor})}function Qc(e){const t=W(e,lt);t.editorLoaded=!1,e.sendMessage(D.Game,{type:ie.DisposeEditor})}function el(e,t){e.sendMessage(D.Game,{type:ie.ToggleSelectedEntity,eid:t})}function tl(e,t){e.sendMessage(D.Game,{type:ie.SetSelectedEntity,eid:t})}function rl(e,t,r,n){e.sendMessage(D.Game,{type:ie.SetProperty,eid:t,propName:r,value:n})}function nl(e,t,r,n){e.sendMessage(D.Game,{type:ie.SetRefProperty,eid:t,propName:r,refEid:n})}function al(e,t,r,n){e.sendMessage(D.Game,{type:ie.SetRefArrayProperty,eid:t,propName:r,refEids:n})}function il(e,t){e.sendMessage(D.Game,{type:ie.AddSelectedEntity,eid:t})}function ol(e,t){e.sendMessage(D.Game,{type:ie.FocusEntity,eid:t})}function sl(e,t,r){e.sendMessage(D.Game,{type:ie.RenameEntity,eid:t,name:r})}function ul(e,t,r,n){e.sendMessage(D.Game,{type:ie.ReparentEntities,entities:t,target:r,position:n})}function Ei(e,t){let r,n;if(e.resourceType===ya.Scene){const a=e;r={id:a.eid,eid:a.eid,name:a.name??"Unnamed",children:[]},n=a.firstNode}else{const a=e;r={id:a.eid,eid:a.eid,name:a.name??"Unnamed",children:[]},t&&t.children.push(r),n=a.firstChild}for(;n;)Ei(n,r),n=n.nextSibling;return r}function cl(e,t){const r=t.resourceDef,n=[],a={id:-1,eid:-1,name:ma(r.name),children:n},i=ke(e,t);for(const o of i)n.push({id:o.eid,eid:o.eid,name:"name"in o&&typeof o.name=="string"?o.name:"Unknown Resource",children:[]});return a}const $u=["Unassigned","Escape","Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace","Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash","CapsLock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Enter","ShiftLeft","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ShiftRight","ControlLeft","AltLeft","MetaLeft","Space","MetaRight","AltRight","ArrowLeft","ArrowUp","ArrowRight","ArrowDown"],Ju=Object.fromEntries($u.map((e,t)=>[e,t]));function xt(e){return Ju[e]||0}var Br=(e=>(e.StopOrbit="start-orbit",e.StartOrbit="stop-orbit",e))(Br||{});const en={name:"player",create(){return{orbiting:!1}},init(e){const t=W(e,en);return _e([ce(e,Br.StartOrbit,()=>{t.orbiting=!0,document.exitPointerLock()}),ce(e,Br.StopOrbit,()=>{var r;t.orbiting=!1,(r=e.canvas)==null||r.requestPointerLock()})])}};var yi=(e=>(e.InitializeInputState="initialize-input-state",e))(yi||{});const he={Unknown:0,Keyboard:1,Mouse:2};var de=(e=>(e[e.Unknown=0]="Unknown",e[e.MouseMovement=1]="MouseMovement",e[e.MouseButtons=2]="MouseButtons",e[e.MouseScroll=3]="MouseScroll",e[e.KeyboardButton=4]="KeyboardButton",e[e.XRFaceButton=5]="XRFaceButton",e[e.XRStandardTrigger=6]="XRStandardTrigger",e[e.XRStandardSqueeze=7]="XRStandardSqueeze",e[e.XRStandardThumbstick=8]="XRStandardThumbstick",e[e.XRStandardTouchpad=9]="XRStandardTouchpad",e[e.XRHandGrasp=10]="XRHandGrasp",e[e.XRTouchpad=11]="XRTouchpad",e[e.XRTouchscreen=12]="XRTouchscreen",e[e.XRXButton=13]="XRXButton",e[e.XRYButton=14]="XRYButton",e[e.XRAButton=15]="XRAButton",e[e.XRBButton=16]="XRBButton",e[e.XRBumper=17]="XRBumper",e[e.XRThumbrest=18]="XRThumbrest",e[e.XRMenu=19]="XRMenu",e))(de||{}),Zu=(e=>(e.FaceButton="face-button",e.XRStandardTrigger="xr-standard-trigger",e.XRStandardSqueeze="xr-standard-squeeze",e.XRStandardThumbstick="xr-standard-thumbstick",e.XRStandardTouchpad="xr-standard-touchpad",e.Grasp="grasp",e.Touchpad="touchpad",e.Touchscreen="touchscreen",e.XButton="x-button",e.YButton="y-button",e.AButton="a-button",e.BButton="b-button",e.Bumper="bumper",e.Thumbrest="thumbrest",e.Menu="menu",e))(Zu||{});const bi=8,Qu=1024*bi,Ur=bi*Float32Array.BYTES_PER_ELEMENT;function ec(e=Qu){const t=Wr(Float32Array,e),r=new ArrayBuffer(Ur),n=new Uint8Array(r),a=er(r);return Object.assign(t,{buffer:r,array:n,view:a})}function Ar(e,t,r,n,a,i,o,f,l){const{view:d}=e;return ct(d,0),nt(d,t),nt(d,r),Et(d,n),Et(d,a),Et(d,i),Et(d,o),Et(d,f),nt(d,l),Fr(e)<Ur?!1:Gr(e,e.array)===Ur}const wi={name:"input",create({inputRingBuffer:e},{sendMessage:t}){return t(D.Game,yi.InitializeInputState,{inputRingBuffer:e}),{nextStackId:0,disableInputStack:[],inputRingBuffer:e}},init(e){const t=W(e,lt),r=W(e,wi),{inputRingBuffer:n}=r,a=W(e,en),{canvas:i}=e,o={};function f(B,x,C,U,T,k,j,$){if(r.disableInputStack.length>0)return;const ne=a.orbiting,le=document.pointerLockElement!==null;t.editorLoaded&&(B===he.Mouse&&x===de.MouseButtons||$===xt("KeyF"))&&Ar(n,B,x,C,U,T,k,j,$),!(!le&&!ne)&&(Ar(n,B,x,C,U,T,k,j,$)||console.warn("input ring buffer full"))}function l(B,x,C,U,T,k,j,$){Ar(n,B,x,C,U,T,k,j,$)||console.warn("input ring buffer full")}function d(){for(const B in o)o[B]&&(l(he.Keyboard,de.KeyboardButton,0,0,0,0,0,xt(B)),o[B]=!1);l(he.Mouse,de.MouseMovement,0,0,0,0,0,0),l(he.Mouse,de.MouseButtons,0,0,0,0,0,0),l(he.Mouse,de.MouseScroll,0,0,0,0,0,0)}function g({buttons:B}){f(he.Mouse,de.MouseButtons,0,0,0,0,0,B)}function E({buttons:B}){f(he.Mouse,de.MouseButtons,0,0,0,0,0,B)}function _({code:B}){o[B]||(o[B]=!0,f(he.Keyboard,de.KeyboardButton,1,0,0,0,0,xt(B)))}function O({code:B}){o[B]=!1,f(he.Keyboard,de.KeyboardButton,0,0,0,0,0,xt(B))}function A({movementX:B,movementY:x,clientX:C,clientY:U}){f(he.Mouse,de.MouseMovement,0,B,x,C,U,0)}function y({deltaX:B,deltaY:x}){f(he.Mouse,de.MouseScroll,0,B,x,0,0,0)}function P(){d()}function M(){d()}function H(){document.pointerLockElement!==i&&d()}return i.addEventListener("mousedown",g),i.addEventListener("mouseup",E),i.addEventListener("mouseleave",M),i.addEventListener("wheel",y),window.addEventListener("keydown",_),window.addEventListener("keyup",O),window.addEventListener("mousemove",A),window.addEventListener("blur",P),document.addEventListener("pointerlockchange",H),()=>{i.removeEventListener("mousedown",g),i.removeEventListener("mouseup",E),i.removeEventListener("mouseleave",M),i.removeEventListener("wheel",y),window.removeEventListener("keydown",_),window.removeEventListener("keyup",O),window.removeEventListener("mousemove",A),window.removeEventListener("blur",P),document.removeEventListener("pointerlockchange",H)}}};var ut=(e=>(e.InitializeNetworkState="InitializeNetworkState",e.AddPeerId="add-peer-id",e.RemovePeerId="remove-peer-id",e.SetHost="set-host",e.PeerEntered="peer-entered",e.PeerExited="peer-exited",e))(ut||{});const $t=16e3;function Wt(e=1e3){const t=Wr(Uint8Array,e*$t),r=new ArrayBuffer($t),n=new Uint8Array(r),a=er(r);return Object.assign(t,{buffer:r,array:n,view:a})}const tc=new Map,rc=(e,t)=>{const r=tc.get(t);return r?(Hr(e,r.byteLength),zr(e,r)):No(e,t),e};function qn(e,t,r,n=!1){const{view:a}=e;return ct(a,0),rc(a,t),Hr(a,n?1:0),nt(a,r.byteLength),zr(a,r),Fr(e)<$t?!1:Gr(e,e.array)===$t}function jn(e,t){if(da(e))return!1;const r=Vr(e,e.array),{view:n}=e;ct(n,0),t.peerId=Mo(n),t.broadcast=!!Xr(n);const a=at(n);return t.packet=To(n,a),r===e.array.length}const nc=[2,3],De={name:"network",async create(e,{sendMessage:t}){const r=Wt(),n=Wt(),a=Wt(),i=Wt();return t(D.Game,ut.InitializeNetworkState,{type:ut.InitializeNetworkState,incomingReliableRingBuffer:r,incomingUnreliableRingBuffer:n,outgoingReliableRingBuffer:a,outgoingUnreliableRingBuffer:i}),{incomingReliableRingBuffer:r,incomingUnreliableRingBuffer:n,outgoingReliableRingBuffer:a,outgoingUnreliableRingBuffer:i,reliableChannels:new Map,unreliableChannels:new Map,incomingMessageHandlers:new Map}},init(e){}};function ac(e){const t=er(e),r=Xr(t);return!nc.includes(r)}const ic=(e,t,r)=>({data:n})=>{if(ac(n)){if(!qn(t.incomingReliableRingBuffer,r,n))throw new Error("incoming reliable network ring buffer full")}else qn(t.incomingUnreliableRingBuffer,r,n)};function tn(e,t){const r=W(e,De),{reliableChannels:n,unreliableChannels:a}=r,i=n.get(t),o=a.get(t),f=r.incomingMessageHandlers.get(t);f&&(i==null||i.removeEventListener("message",f),o==null||o.removeEventListener("message",f),r.incomingMessageHandlers.delete(t)),n.delete(t),a.delete(t);const l=W(e,Ee);vi(l,t,void 0),e.sendMessage(D.Game,{type:ut.RemovePeerId,peerId:t})}function ll(e,t){const r=W(e,De);r.hostId!==t&&(console.info("electing new host",t),r.hostId=t,e.sendMessage(D.Game,{type:ut.SetHost,hostId:t}))}function fl(e,t){const r=W(e,De),{reliableChannels:n}=r;return n.has(t)}function dl(e,t,r,n){const a=W(e,De),i=W(e,Ee),{reliableChannels:o,unreliableChannels:f}=a;if(o.has(t)){console.warn("peer already added",t);return}r.ordered?o.set(t,r):f.set(t,r);const l=()=>{const d=()=>{tn(e,t)},g=ic(e,a,t);a.incomingMessageHandlers.set(t,g),r.addEventListener("message",g),r.addEventListener("close",d),e.sendMessage(D.Game,{type:ut.AddPeerId,peerId:t})};r.binaryType="arraybuffer",r.readyState==="open"?l():r.addEventListener("open",l),n&&vi(i,t,n)}function ml(e,t){tn(e,t)}function pl(e,t){const n=W(e,Ee).mediaStreams.get(t);if(n){const a=n.getAudioTracks();a[0].enabled?a.forEach(i=>i.enabled=!1):a.forEach(i=>i.enabled=!0)}}function hl(e,t){const n=W(e,Ee).mediaStreams.get(t);if(n)return!n.getAudioTracks()[0].enabled}function gl(e){const t=W(e,De),{reliableChannels:r}=t;for(const[n]of r)tn(e,n)}const fe={packet:new ArrayBuffer(0),peerId:"",broadcast:!1};function oc(e){const t=W(e,De);for(;Xt(t.outgoingReliableRingBuffer);)if(jn(t.outgoingReliableRingBuffer,fe),fe.broadcast)t.reliableChannels.forEach(r=>{if(r.readyState!=="open"){console.error("peer's reliable channel is not open");return}r.send(fe.packet)});else{const r=t.reliableChannels.get(fe.peerId);if(!r){console.error("Failed to send message, peer's reliable channel not found",fe.peerId);continue}r.send(fe.packet)}for(;Xt(t.outgoingUnreliableRingBuffer);)if(jn(t.outgoingUnreliableRingBuffer,fe),fe.broadcast)t.reliableChannels.forEach(r=>{if(r.readyState!=="open"){console.error("peer's unreliable channel is not open");return}r.send(fe.packet)});else{const r=t.reliableChannels.get(fe.peerId);if(!r){console.error("peer's unreliable channel is not found",fe.peerId);continue}r.send(fe.packet)}}const sc="renderer";var Be=(e=>(e.InitializeRenderer="renderer-initialize-canvas",e.InitializeRendererTripleBuffers="initialize-renderer-triple-buffers",e.NotifySceneRendered="renderer-notify-scene-renderer",e.SceneRenderedNotification="renderer-scene-rendered-notification",e.CanvasResize="canvas-resize",e.EnableMatrixMaterial="enable-matrix-material",e.EnterXR="enter-xr",e.InitializeGameRendererTripleBuffer="initialize-game-renderer-triple-buffer",e.TogglePhysicsDebug="toggle-physics-debug",e.PhysicsEnableDebugRender="physics-enable-debug-render",e.PhysicsDisableDebugRender="physics-disable-debug-render",e.SetNodeOptimizationsEnabled="set-node-optimizations-enabled",e.PrintRenderThreadState="print-render-thread-state",e.UICanvasPress="ui-canvas-press",e.UICanvasFocus="ui-canvas-focus",e.UIButtonPress="ui-button-press",e.UIButtonFocus="ui-button-focus",e.UIButtonUnfocus="ui-button-unfocus",e.UpdateXRInputSources="update-xr-input-sources",e.SetXRReferenceSpace="set-xr-reference-space",e))(Be||{}),uc=(e=>(e[e.None=0]="None",e[e.ImmersiveVR=1]="ImmersiveVR",e[e.ImmersiveAR=2]="ImmersiveAR",e))(uc||{});const vl={"immersive-vr":1,"immersive-ar":2},cc="render-quality";function lc(e){switch(e){case 0:return 0;case 1:return 0;case 2:return 1;case 3:return 2;default:return 1}}var tt=(e=>(e.Auto="auto",e.Low="low",e.Medium="medium",e.High="high",e.Ultra="ultra",e))(tt||{});const El=[{label:"Low",value:"low"},{label:"Medium",value:"medium"},{label:"High",value:"high"},{label:"Ultra",value:"ultra"}];var Ve=(e=>(e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High",e[e.Ultra=3]="Ultra",e))(Ve||{});const yl={[0]:"low",[1]:"medium",[2]:"high",[3]:"ultra"};var ue=(e=>(e[e.fps=0]="fps",e[e.frameTime=1]="frameTime",e[e.frameDuration=2]="frameDuration",e[e.frame=3]="frame",e[e.staleFrames=4]="staleFrames",e[e.drawCalls=5]="drawCalls",e[e.programs=6]="programs",e[e.geometries=7]="geometries",e[e.textures=8]="textures",e[e.triangles=9]="triangles",e[e.points=10]="points",e[e.lines=11]="lines",e))(ue||{});const fc=Object.keys(ue).filter(e=>isNaN(+e)),bl={matrix:[Float32Array,16]},wl={rayPose:[Float32Array,16],gripPose:[Float32Array,16]},Rl={matrices:[Float32Array,25,16],radii:[Float32Array,25]},Ri={name:sc,async create({canvas:e,inputRingBuffer:t,useOffscreenCanvas:r,supportedXRSessionModes:n,quality:a},{sendMessage:i}){const o=r?e.transferControlToOffscreen():e,f=hc();return i(D.Render,Be.InitializeRenderer,{canvasTarget:r?o:void 0,initialCanvasWidth:e.clientWidth,initialCanvasHeight:e.clientHeight,supportedXRSessionModes:n,quality:a,statsBuffer:f,inputRingBuffer:t},r?[o]:void 0),{statsBuffer:f}},init(e){return e.sendMessage(D.Render,{type:Be.CanvasResize,canvasWidth:e.canvas.clientWidth,canvasHeight:e.canvas.clientHeight}),e.sendMessage(D.Game,{type:Be.CanvasResize,canvasWidth:e.canvas.clientWidth,canvasHeight:e.canvas.clientHeight}),_e([dc(e)])}},dc=e=>{function t(){e.sendMessage(D.Render,{type:Be.CanvasResize,canvasWidth:e.canvas.clientWidth,canvasHeight:e.canvas.clientHeight}),e.sendMessage(D.Game,{type:Be.CanvasResize,canvasWidth:e.canvas.clientWidth,canvasHeight:e.canvas.clientHeight})}return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}};function mc(e){e.sendMessage(D.Game,{type:Be.TogglePhysicsDebug})}function pc(e){e.sendMessage(D.Render,{type:Be.PrintRenderThreadState})}function hc(){const e=new SharedArrayBuffer(Float32Array.BYTES_PER_ELEMENT*fc.length);return{buffer:e,f32:new Float32Array(e),u32:new Uint32Array(e)}}var Jt=(e=>(e[e.gameTime=0]="gameTime",e[e.gameDuration=1]="gameDuration",e))(Jt||{});const Si=Object.keys(Jt).filter(e=>isNaN(+e));var Ai=(e=>(e.InitializeStatsBuffer="initialize-stats-buffer",e))(Ai||{});const rn={name:"stats",create(e,{sendMessage:t}){const r=gc();return t(D.Game,Ai.InitializeStatsBuffer,{statsBuffer:r}),{buffer:r,stats:Object.fromEntries(Si.map(n=>[n,0]))}},init(e){const t=W(e,rn);e.initialGameWorkerState.statsBuffer=t.buffer,e.initialRenderWorkerState.statsBuffer=t.buffer}};function gc(){const e=new SharedArrayBuffer(Float32Array.BYTES_PER_ELEMENT*Si.length);return{buffer:e,f32:new Float32Array(e),u32:new Uint32Array(e)}}function Sl(e){const{stats:t,buffer:r}=W(e,rn),{statsBuffer:n}=W(e,Ri);return t.fps=n.f32[ue.fps].toFixed(2),t.frameTime=n.f32[ue.frameTime].toFixed(2),t.frameDuration=(n.f32[ue.frameDuration]*1e3).toFixed(2),t.gameTime=(r.f32[Jt.gameTime]*1e3).toFixed(2),t.gameDuration=r.f32[Jt.gameDuration].toFixed(2),t.frame=n.u32[ue.frame],t.staleFrames=n.u32[ue.staleFrames],t.drawCalls=n.u32[ue.drawCalls],t.programs=n.u32[ue.programs],t.geometries=n.u32[ue.geometries],t.textures=n.u32[ue.textures],t.triangles=n.u32[ue.triangles],t.points=n.u32[ue.points],t.lines=n.u32[ue.lines],t}const St={name:"thirdroom",create(){return{messageId:0,actionBarItems:[]}},init(e){return kt("printThreadState",()=>{e.sendMessage(D.Game,{type:ae.PrintThreadState}),pc(e),console.log(D.Main,e)}),kt("printResources",()=>{e.sendMessage(D.Game,{type:ae.PrintResources})}),kt("findResourceRetainers",t=>{e.sendMessage(D.Game,{type:ae.FindResourceRetainers,resourceId:t})}),kt("togglePhysicsDebug",()=>{mc(e)}),_e([ce(e,ae.SetActionBarItems,vc)])}};async function Al(e,t,r){const n=W(e,St),a=Rt(!1),i=n.messageId++;let o;const f=(d,g)=>{g.id===i&&(g.url===n.environmentUrl?a.resolve(void 0):a.reject(new Error("Environment changed before it was finished loading.")),o())},l=(d,g)=>{console.log("error",g),g.id===i&&(a.reject(new Error(g.error)),o())};return o=_e([ce(e,ae.WorldLoaded,f),ce(e,ae.WorldLoadError,l)]),n.environmentUrl=t,e.sendMessage(D.Game,{type:ae.LoadWorld,id:i,environmentUrl:t,options:r}),a.promise}function Ll(e,t){const r=W(e,St),n=W(e,De),a=Rt(!1),i=r.messageId++;let o;const f=(d,g)=>{g.id===i&&(a.resolve(void 0),o())},l=(d,g)=>{console.log("error",g),g.id===i&&(a.reject(new Error(g.error)),o())};return o=_e([ce(e,ae.EnteredWorld,f),ce(e,ae.EnterWorldError,l)]),n.peerId=t,e.sendMessage(D.Game,{type:ae.EnterWorld,id:i,localPeerId:t}),a.promise}function _l(e,t,r){const n=W(e,St),a=Rt(!1),i=n.messageId++;let o;const f=(d,g)=>{g.id===i&&(a.resolve(void 0),o())},l=(d,g)=>{console.log("error",g),g.id===i&&(a.reject(new Error(g.error)),o())};return o=_e([ce(e,ae.ReloadedWorld,f),ce(e,ae.ReloadWorldError,l)]),e.sendMessage(D.Game,{type:ae.ReloadWorld,id:i,environmentUrl:t,options:r}),a.promise}function Nl(e){e.sendMessage(D.Game,{type:ae.ExitWorld})}function vc(e,t){const r=W(e,St);r.actionBarItems=t.actionBarItems}function Ec(e){Ro(e.gameToMainTripleBufferFlags)}function yc(e){So(e.mainToGameTripleBufferFlags)}var rr=(e=>(e.WidgetMessage="widget-message",e))(rr||{}),Zt=(e=>(e.FromWidget="fromWidget",e.ToWidget="toWidget",e))(Zt||{}),bt=(e=>(e.ContentLoaded="content_loaded",e.SendEvent="send_event",e.ReadEvents="read_events",e))(bt||{});const nr={name:"matrix",create:()=>({widgets:new Map}),init(e){return _e([ce(e,rr.WidgetMessage,bc)])}};function bc(e,t){const r=W(e,nr),n=t.message;if(!(!n.action||!n.requestId||!n.widgetId))if("response"in n){if(n.api!==Zt.ToWidget)return;Lc(r.widgets,n)}else{if(n.api!==Zt.FromWidget)return;Ac(e,r,n)}}function wc(e){const t=`widgetapi-${Date.now()}`;let r=0,n=t;for(;e.outboundRequests.has(n);)n=`${t}-${r++}`;return e.outboundRequests.set(n,null),n}function ve(e,t,r){e.sendMessage(D.Game,{type:rr.WidgetMessage,message:{...t,response:r}})}function Rc(e,t,r,n){const a={api:Zt.ToWidget,widgetId:t.widgetId,requestId:wc(t),action:r,data:n},i=Rt(10*1e3,"Request timed out.");return t.outboundRequests.set(a.requestId,i),e.sendMessage(D.Game,{type:rr.WidgetMessage,message:a}),i.promise.finally(()=>{t.outboundRequests.delete(a.requestId)})}function Sc(e,t,r,n){return Rc(e,t,r,n).then(a=>a.response)}function Ac(e,t,r){const{widgets:n}=t,a=r.action;if(a===bt.ContentLoaded){if(!n.has(r.widgetId)){const o={widgetId:r.widgetId,outboundRequests:new Map,capabilities:new Map([["m.send.event",new Set(["m.room.message#m.text"])],["m.receive.event",new Set(["m.room.message","org.matrix.msc3672.beacon"])]])};n.set(r.widgetId,o),ve(e,r,{}),_c(e,t,o)}return}const i=n.get(r.widgetId);if(i)switch(a){case bt.SendEvent:return Nc(e,t,i,r);case bt.ReadEvents:return Pc(e,t,i,r);default:return ve(e,r,{error:{message:"Unknown or unsupported action: "+a}})}}function Lc(e,t){const r=e.get(t.widgetId);if(!r)return;const n=r.outboundRequests.get(t.requestId);n&&("error"in t.response&&t.response.error.message?n.reject(t.response.error.message):n.resolve(t))}async function _c(e,t,r){if(!t.activeSession)throw new Error("No session set");const a=t.activeRoom;if(!a)throw new Error("Room not loaded yet");const i=await a.openTimeline(),o=i.entries.subscribe({onAdd(f,l,d){var g;!("isPending"in l)&&"event"in l&&((g=r.capabilities.get("m.receive.event"))!=null&&g.has(l.eventType))&&Sc(e,r,bt.SendEvent,l.event).catch(E=>{console.error(E)})},onMove(f,l,d,g){},onRemove(f,l,d){},onUpdate(f,l,d,g){},onReset(f){}});r.disposeTimeline=()=>{o(),i.dispose()}}function it(e,t,r,n,a,i,o){const f=t.capabilities.get(n);return(i?f==null?void 0:f.has(`${a}#${o}`):f==null?void 0:f.has(`${a}`))?!0:(console.error(`Capability not allowed ${n} ${a} ${o}`,t.capabilities),ve(e,r,{error:{message:"Capability not allowed"}}),!1)}function Nc(e,t,r,n){const a=t.activeSession;if(!a)throw new Error("No session set");const i=t.activeRoom;if(!i)throw new Error("Room not loaded yet");const o=n.data;if(!o.type)return ve(e,n,{error:{message:"Invalid request - missing event type"}});let f;if(o.state_key!==null&&o.state_key!==void 0){if(!it(e,r,n,"m.send.state_event",o.type,!0,o.state_key))return;f=a.hsApi.sendState(i.id,o.type,o.state_key,o.content||{}).response()}else{if(o.type==="m.room.message"){if(!("msgtype"in o.content))return ve(e,n,{error:{message:"Invalid request - missing msgtype"}});if(!it(e,r,n,"m.send.event",o.type,!0,o.content.msgtype))return}else if(!it(e,r,n,"m.send.event",o.type,!1))return;f=i.sendEvent(o.type,o.content)}f.then(l=>{ve(e,n,{room_id:l==null?void 0:l.room_id,event_id:l==null?void 0:l.event_id})}).catch(l=>{console.error("Error sending event: ",l),ve(e,n,{error:{message:"Error sending event"}})})}const Tc=1e3;function Pc(e,t,r,n){if(!t.activeSession)throw new Error("No session set");const i=t.activeRoom;if(!i)throw new Error("Room not loaded yet");const o=n.data;if(!o.type)return ve(e,n,{error:{message:"Invalid request - missing event type"}});if(o.limit!==void 0&&(!o.limit||o.limit<0))return ve(e,n,{error:{message:"Invalid request - limit out of range"}});if(o.room_ids!==void 0)return ve(e,n,{error:{message:"Reading events from multiple rooms is not currently supported."}});const f=o.limit||0;let l=Promise.resolve([]);if(o.state_key!==void 0){const d=o.state_key===!0?void 0:o.state_key.toString();if(d){if(!it(e,r,n,"m.receive.event",o.type,!0,d))return;l=i.observeStateTypeAndKey(o.type,d).then(g=>{const E=g.get();return E?[E]:[]})}else{if(!it(e,r,n,"m.receive.event",o.type,!1))return;l=i.observeStateType(o.type).then(g=>{const E=Array.from(g.values());return f?E.slice(0,f):E})}}else{if(!it(e,r,n,"m.receive.event",o.type,!1))return;l=i.openTimeline().then(async d=>{const g=[],E=Rt(3e3),_=d.entries.subscribe({onAdd(O,A,y){!("isPending"in A)&&"event"in A&&A.eventType===o.type&&(g.push(A.event),g.length>=f&&E.resolve())},onMove(O,A,y,P){},onRemove(O,A,y){},onUpdate(O,A,y,P){},onReset(O){}});await d.loadAtTop(Tc);try{await E.promise}catch{}return _(),d.dispose(),g})}return l.then(d=>{ve(e,n,{events:d})})}function Tl(e,t,r){const n=W(e,nr),a=t.rooms.get(r);if(!a)throw new Error("Cannot find room");n.activeRoom=a,n.activeSession=t}function Pl(e){const t=W(e,nr);t.activeRoom=void 0,t.activeSession=void 0;for(const r of t.widgets.values()){for(const n of r.outboundRequests.values())n==null||n.reject("Closed Widget");r.disposeTimeline&&r.disposeTimeline()}t.widgets.clear()}const Yn={modules:[vu,lt,Ee,De,wi,rn,Ri,St,nr,en],systems:[Ec,mi,_u,oc,qu,yc,yu]},Mc=(e,t=100)=>{const r=e();return r?Promise.resolve(r):new Promise(n=>{const a=setInterval(()=>{const i=e();i&&(clearInterval(a),n(i))},t)})};async function Oc(){let e=!1;return"xr"in navigator&&navigator.xr?(e=[],await navigator.xr.isSessionSupported("immersive-ar")&&e.push("immersive-ar"),await navigator.xr.isSessionSupported("immersive-vr")&&e.push("immersive-vr"),e.length===0?!1:e):!1}async function Cc(){const e=new URL("/detect-gpu-benchmarks",document.location.href).href,t=localStorage.getItem(cc),r=t?JSON.parse(t):void 0;let n;if(!r||r===tt.Auto){const a=await ro({benchmarksURL:e,mobileTiers:[0,60,90,120],desktopTiers:[0,60,90,120]});console.info(`GPU Detected: "${a.gpu}" Tier: ${a.tier}`),a.type!=="BENCHMARK"?n=Ve.Medium:n=lc(a.tier)}else r===tt.Low?n=Ve.Low:r===tt.Medium?n=Ve.Medium:r===tt.High?n=Ve.High:r===tt.Ultra?n=Ve.Ultra:n=Ve.Medium;return n}async function Ic(e){const t=!!window.OffscreenCanvas,[,r]=window.location.hash.split("?"),n=new URLSearchParams(window.location.search||r).get("renderMain"),a=await Oc(),i=await Cc(),o=t&&n===null&&!a,f=o?void 0:{useXRViewerWorldMatrix:!1,xrViewerWorldMatrix:new Float32Array(16),update:()=>{}},l=ec(),d=new no,g=await Bc(e,d,o,f),E=new MessageChannel;function _(T,k,j){T===D.Game?d.postMessage({dest:T,message:k},j):T===D.Render&&g.postMessage({dest:T,message:k},j)}const O=new Uint8Array(new SharedArrayBuffer(Uint8Array.BYTES_PER_ELEMENT)).fill(6),A=new Uint8Array(new SharedArrayBuffer(Uint8Array.BYTES_PER_ELEMENT)).fill(6),y=new Uint8Array(new SharedArrayBuffer(Uint8Array.BYTES_PER_ELEMENT)).fill(6),P=new Uint8Array(new SharedArrayBuffer(Uint8Array.BYTES_PER_ELEMENT)).fill(6),M={thread:D.Main,mainToGameTripleBufferFlags:O,gameToMainTripleBufferFlags:P,systems:Yn.systems,modules:new Map,useOffscreenCanvas:o,canvas:e,messageHandlers:new Map,initialGameWorkerState:{},initialRenderWorkerState:{},sendMessage:_,worldResource:void 0,supportedXRSessionModes:a,isStaleFrame:!1,dt:0,elapsed:0,tick:0,singleConsumerThreadSharedState:f,quality:i,inputRingBuffer:l};function H(T){const{message:k,dest:j}=T.data;if(j!==D.Main)return;const $=M.messageHandlers.get(k.type);if($)for(let ne=0;ne<$.length;ne++)$[ne](M,k)}d.addEventListener("message",H),g.addEventListener("message",H);const B=$i(D.Main,M,Yn.modules);M.sendMessage(D.Game,{type:_r.InitializeGameWorker,renderWorkerMessagePort:o?E.port1:void 0,mainToGameTripleBufferFlags:O,gameToMainTripleBufferFlags:P,gameToRenderTripleBufferFlags:y,renderToGameTripleBufferFlags:A},o?[E.port1]:void 0),M.sendMessage(D.Render,{type:_r.InitializeRenderWorker,gameWorkerMessageTarget:o?E.port2:void 0,gameToRenderTripleBufferFlags:y,renderToGameTripleBufferFlags:A},o?[E.port2]:void 0);const x=await B;M.worldResource=await Mc(()=>(mi(M),ke(M,di)[0]));const C=()=>{const T=performance.now();M.dt=(T-M.elapsed)/1e3,M.elapsed=T;for(let k=0;k<M.systems.length;k++)M.systems[k](M)};function U(){C(),M.animationFrameId=requestAnimationFrame(U)}return console.log("MainThread initialized"),f?f.update=C:U(),{ctx:M,dispose(){M.animationFrameId!==void 0&&cancelAnimationFrame(M.animationFrameId),x(),d.removeEventListener("message",H),g.removeEventListener("message",H),d instanceof Worker&&d.terminate(),g instanceof Worker&&g.terminate()}}}async function Bc(e,t,r,n){if(r){console.info("Browser supports OffscreenCanvas, rendering in WebWorker.");const{default:a}=await En(()=>import("./RenderWorker-bd678fc2.js"),[]);return new a}else{console.info("Browser does not support OffscreenCanvas, rendering on main thread.");const{default:a}=await En(()=>import("./RenderWorker-7d643d11.js"),["assets/RenderWorker-7d643d11.js","assets/Deferred-af9e678f.js","assets/math-0381bedb.js","assets/ktx-parse.modern-6c6da609.js","assets/main.cc7980d7.js","assets/modulepreload-polyfill-3cfb730f.js","assets/index-13570d13.css"]);return a(e,t,n)}}function Ml(e){const[t,r]=Vt.useState(),n=zi();return Vt.useEffect(()=>{if(e.current){let a;return Ic(e.current).then(({ctx:i,dispose:o})=>{n()?(a=o,r(i)):o()}),()=>{a&&a()}}},[n,e]),t}const Li=Vt.createContext(void 0),Ol=Li.Provider;function Cl(){const e=Vt.useContext(Li);if(!e)throw new Error("Main Thread hasn't been initialized yet");return e}var Uc=(e=>(e.SceneInspector="scene_inspector",e.SceneEditor="scene_editor",e.ScriptEditor="script_editor",e))(Uc||{}),kc=(e=>(e.Scenes="Scenes",e.Resources="Resources",e))(kc||{});const Il=Le(!1),Bl=Le("scene_inspector"),Ul=Le("Scenes"),Gt=Le({selected:tr,options:[]}),kl=Le(e=>e(Gt),(e,t,r)=>{const n=e(Gt);t(Gt,{selected:r.selected??n.selected,options:r.options??n.options})}),Qe=Le([]),_i={activeEntityHistoryIndex:-1,activeEntityHistorySize:0,activeEntity:pa,selectedEntities:[]},Oe=Le(_i),Dl=Le(e=>e(Oe),(e,t,r)=>{if(r.type==="SELECT"){const n=e(Oe);if(n.activeEntity===r.resourceId)return;const a={...n};a.activeEntity=r.resourceId,a.selectedEntities=[r.resourceId];let i=[...e(Qe)];r.isRef?(n.activeEntityHistoryIndex<i.length-1&&(i=i.slice(0,n.activeEntityHistoryIndex+1)),n.activeEntityHistorySize===0&&i.push(n.activeEntity),i.push(r.resourceId),a.activeEntityHistoryIndex=i.length-1,a.activeEntityHistorySize=i.length,t(Qe,i)):i.length>0&&(a.activeEntityHistoryIndex=-1,a.activeEntityHistorySize=0,t(Qe,[])),t(Oe,a);return}if(r.type==="SELECT_BACKWARD"){const n=e(Oe),a={...n},i=[...e(Qe)];if(n.activeEntityHistoryIndex<1)return;const o=i[n.activeEntityHistoryIndex-1];a.activeEntityHistoryIndex-=1,a.activeEntity=o,a.selectedEntities=[o],t(Oe,a);return}if(r.type==="SELECT_FORWARD"){const n=e(Oe),a={...n},i=[...e(Qe)];if(n.activeEntityHistoryIndex>=n.activeEntityHistorySize-1)return;const o=i[n.activeEntityHistoryIndex+1];a.activeEntityHistoryIndex+=1,a.activeEntity=o,a.selectedEntities=[o],t(Oe,a);return}r.type==="RESET"&&(t(Qe,[]),t(Oe,_i),t(Gt,{selected:tr,options:[]}))}),Dc=`
world.onload = () => {
    
    

    world.onenter = () => {
        
    };
    
    world.onupdate = (dt, time) => {

    };

};
`,xl=Le(Dc);export{ll as $,ol as A,sl as B,ul as C,ke as D,lt as E,nl as F,al as G,kc as H,Ya as I,rl as J,xl as K,cc as L,Ol as M,Dc as N,Bl as O,en as P,Uc as Q,tt as R,Sl as S,ae as T,Ee as U,hl as V,ml as W,pl as X,wi as Y,mc as Z,Jc as _,D as a,vl as a$,dl as a0,fl as a1,gl as a2,Nl as a3,Pl as a4,Tl as a5,Al as a6,Ll as a7,_l as a8,$r as a9,qa as aA,ja as aB,Zr as aC,$a as aD,Ja as aE,Za as aF,Qa as aG,ei as aH,ri as aI,ai as aJ,Ie as aK,Qr as aL,si as aM,Ws as aN,qt as aO,ui as aP,Fs as aQ,xo as aR,Ve as aS,qc as aT,xs as aU,Gc as aV,sc as aW,jc as aX,ga as aY,bl as aZ,he as a_,Wa as aa,Ga as ab,Fa as ac,F as ad,ba as ae,Aa as af,La as ag,ot as ah,Na as ai,Ta as aj,jr as ak,Yr as al,Ae as am,ge as an,Kr as ao,Ia as ap,Oa as aq,Ca as ar,Ua as as,Da as at,xa as au,He as av,Ha as aw,Jr as ax,za as ay,Xa as az,Cl as b,uc as b0,wl as b1,Rl as b2,Bo as b3,Ro as b4,So as b5,ka as b6,bu as b7,Ra as b8,wa as b9,Tr as ba,Sa as bb,Ma as bc,Hc as bd,Ba as be,Va as bf,ue as bg,Zu as bh,de as bi,zt as bj,zc as bk,va as bl,Ar as bm,Vc as bn,_r as bo,$i as bp,Mc as bq,_e as c,Xc as d,El as e,yl as f,Il as g,Be as h,W as i,St as j,Ul as k,kl as l,Dl as m,cl as n,Eu as o,Xu as p,Zc as q,ce as r,tl as s,Qc as t,Ml as u,vu as v,ma as w,tr as x,el as y,il as z};
//# sourceMappingURL=editor-9e67c00a.js.map
