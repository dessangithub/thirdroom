{"version":3,"file":"Scrubber-f5381c63.js","sources":["../../../src/ui/atoms/portal/Portal.ts","../../../res/ic/horizontal-resize.svg","../../../src/ui/views/components/scrubber/Scrubber.tsx"],"sourcesContent":["import { ReactNode } from \"react\";\nimport { createPortal } from \"react-dom\";\n\ninterface PortalProps {\n  container?: Element;\n  children: ReactNode;\n}\n\nexport function Portal({ children, container }: PortalProps) {\n  return createPortal(children, container ?? document.body);\n}\n","export default \"__VITE_ASSET__d135abe6__\"","import { MouseEvent as RMouseEvent, ReactNode, useRef, useState } from \"react\";\n\nimport { Portal } from \"../../../atoms/portal/Portal\";\nimport HorizontalResizeIC from \"../../../../../res/ic/horizontal-resize.svg\";\nimport \"./Scrubber.css\";\nimport { Icon } from \"../../../atoms/icon/Icon\";\nimport { clamp } from \"../../../utils/common\";\n\ninterface ScrubberProps {\n  value: number;\n  onChange: (value: number) => void;\n  min?: number;\n  max?: number;\n  children: ReactNode;\n}\n\ninterface IScrubber {\n  x: number;\n  y: number;\n}\n\nexport function Scrubber({ value, onChange, min, max, children }: ScrubberProps) {\n  const scrubberRef = useRef<HTMLSpanElement>(null);\n  const [scrubber, setScrubber] = useState<IScrubber>();\n  const valueRef = useRef(value);\n\n  function handleMouseDown(evt: RMouseEvent) {\n    valueRef.current = value;\n    evt.preventDefault();\n    setScrubber({\n      x: evt.clientX,\n      y: evt.clientY,\n    });\n    scrubberRef.current?.requestPointerLock();\n\n    document.addEventListener(\"mousemove\", handleMouseMove);\n    document.addEventListener(\"mouseup\", handleMouseUp);\n  }\n\n  function handleMouseMove(evt: MouseEvent) {\n    evt.preventDefault();\n    evt.stopPropagation();\n    const newValue = clamp(valueRef.current + evt.movementX, min, max);\n    onChange(newValue);\n    valueRef.current = newValue;\n\n    setScrubber((scrubber) => {\n      const { x, y } = scrubber ?? { x: 0, y: 0 };\n      let mX = x + evt.movementX;\n      let mY = y + evt.movementY;\n\n      if (mX > window.innerWidth) mX -= window.innerWidth;\n      else if (mX < 0) mX += window.innerWidth;\n      if (mY > window.innerHeight) mY -= window.innerHeight;\n      else if (mY < 0) mY += window.innerHeight;\n\n      return { x: mX, y: mY };\n    });\n  }\n\n  function handleMouseUp(evt: MouseEvent) {\n    evt.preventDefault();\n    setScrubber(undefined);\n    document.exitPointerLock();\n\n    document.removeEventListener(\"mousemove\", handleMouseMove);\n    document.removeEventListener(\"mouseup\", handleMouseUp);\n  }\n\n  return (\n    <span className=\"Scrubber\" ref={scrubberRef} onMouseDown={handleMouseDown}>\n      {children}\n      {scrubber && (\n        <Portal>\n          <span\n            className=\"Scrubber__cursor\"\n            style={{\n              transform: `translate(calc(${scrubber.x}px - 50%), calc(${scrubber.y}px - 38%))`,\n            }}\n          >\n            <Icon color=\"surface\" src={HorizontalResizeIC} />\n          </span>\n        </Portal>\n      )}\n    </span>\n  );\n}\n"],"names":["Portal","children","container","createPortal","HorizontalResizeIC","Scrubber","value","onChange","min","max","scrubberRef","useRef","scrubber","setScrubber","useState","valueRef","handleMouseDown","evt","_a","handleMouseMove","handleMouseUp","newValue","clamp","scrubber2","y","mX","mY","jsxs","jsx","Icon"],"mappings":"qNAQO,SAASA,EAAO,CAAE,SAAAC,EAAU,UAAAC,GAA0B,CAC3D,OAAOC,EAAa,aAAAF,EAAUC,GAAa,SAAS,IAAI,CAC1D,CCVA,MAAeE,EAAA,mDCqBR,SAAAC,EAAA,CAAA,MAAAC,EAAA,SAAAC,EAAA,IAAAC,EAAA,IAAAC,EAAA,SAAAR,GAAA,CACL,MAAAS,EAAAC,SAAA,IAAA,EACA,CAAAC,EAAAC,CAAA,EAAAC,EAAA,SAAA,EACAC,EAAAJ,SAAAL,CAAA,EAEA,SAAAU,EAAAC,EAAA,OACEF,EAAA,QAAAT,EACAW,EAAA,eAAA,EACAJ,EAAA,CAAY,EAAAI,EAAA,QACH,EAAAA,EAAA,OACA,CAAA,GAETC,EAAAR,EAAA,UAAA,MAAAQ,EAAA,qBAEA,SAAA,iBAAA,YAAAC,CAAA,EACA,SAAA,iBAAA,UAAAC,CAAA,CAAkD,CAGpD,SAAAD,EAAAF,EAAA,CACEA,EAAA,eAAA,EACAA,EAAA,gBAAA,EACA,MAAAI,EAAAC,EAAAP,EAAA,QAAAE,EAAA,UAAAT,EAAAC,CAAA,EACAF,EAAAc,CAAA,EACAN,EAAA,QAAAM,EAEAR,EAAAU,GAAA,CACE,KAAA,CAAA,EAAA,EAAAC,CAAA,EAAAD,GAAA,CAAA,EAAA,EAAA,EAAA,GACA,IAAAE,EAAA,EAAAR,EAAA,UACAS,EAAAF,EAAAP,EAAA,UAEA,OAAAQ,EAAA,OAAA,WAA4BA,GAAA,OAAA,WAAaA,EAAA,IACxBA,GAAA,OAAA,YACjBC,EAAA,OAAA,YAA6BA,GAAA,OAAA,YAAaA,EAAA,IACzBA,GAAA,OAAA,aAEjB,CAAA,EAAAD,EAAA,EAAAC,CAAA,CAAsB,CAAA,CACvB,CAGH,SAAAN,EAAAH,EAAA,CACEA,EAAA,eAAA,EACAJ,EAAA,MAAA,EACA,SAAA,gBAAA,EAEA,SAAA,oBAAA,YAAAM,CAAA,EACA,SAAA,oBAAA,UAAAC,CAAA,CAAqD,CAGvD,OAAAO,EAAA,OAAA,CAAA,UAAA,WAAA,IAAAjB,EAAA,YAAAM,EAAA,SAAA,CAEKf,EAAAW,GAAAgB,EAAA5B,EAAA,CAAA,SAAA4B,EAGG,OAAC,CAAA,UAAA,mBACW,MAAA,CACH,UAAA,kBAAAhB,EAAA,oBAAAA,EAAA,aAC8D,EACrE,SAAAgB,EAAAC,EAAA,CAAA,MAAA,UAAA,IAAAzB,EAAA,CAE+C,CAAA,EAAA,CAEnD,CAAA,CAAA,CAIR"}